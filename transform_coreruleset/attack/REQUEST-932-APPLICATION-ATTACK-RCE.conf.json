{
   "access" : [
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "932011",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "1",
         "skip_after" : "END-REQUEST-932-APPLICATION-ATTACK-RCE",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "DETECTION_PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "932012",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "1",
         "skip_after" : "END-REQUEST-932-APPLICATION-ATTACK-RCE",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "DETECTION_PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL1",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932100",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Unix Command Injection",
         "operator" : "REGEX",
         "pattern" : "(?:;|\\{|\\||\\|\\||&|&&|\\n|\\r|\\$\\(|\\$\\(\\(|`|\\${|<\\(|>\\(|\\(\\s*\\))\\s*(?:{|\\s*\\(\\s*|\\w+=(?:[^\\s]*|\\$.*|\\$.*|<.*|>.*|\\'.*\\'|\".*\")\\s+|!\\s*|\\$)*\\s*(?:'|\")*(?:[\\?\\*\\[\\]\\(\\)\\-\\|+\\w'\"\\./\\x5c]+/)?[\\x5c'\"]*(?:l[\\x5c'\"]*(?:w[\\x5c'\"]*p[\\x5c'\"]*-[\\x5c'\"]*(?:d[\\x5c'\"]*(?:o[\\x5c'\"]*w[\\x5c'\"]*n[\\x5c'\"]*l[\\x5c'\"]*o[\\x5c'\"]*a[\\x5c'\"]*d|u[\\x5c'\"]*m[\\x5c'\"]*p)|r[\\x5c'\"]*e[\\x5c'\"]*q[\\x5c'\"]*u[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*t|m[\\x5c'\"]*i[\\x5c'\"]*r[\\x5c'\"]*r[\\x5c'\"]*o[\\x5c'\"]*r)|s(?:[\\x5c'\"]*(?:b[\\x5c'\"]*_[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*l[\\x5c'\"]*e[\\x5c'\"]*a[\\x5c'\"]*s[\\x5c'\"]*e|c[\\x5c'\"]*p[\\x5c'\"]*u|m[\\x5c'\"]*o[\\x5c'\"]*d|p[\\x5c'\"]*c[\\x5c'\"]*i|u[\\x5c'\"]*s[\\x5c'\"]*b|-[\\x5c'\"]*F|h[\\x5c'\"]*w|o[\\x5c'\"]*f))?|z[\\x5c'\"]*(?:(?:[ef][\\x5c'\"]*)?g[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*p|c[\\x5c'\"]*(?:a[\\x5c'\"]*t|m[\\x5c'\"]*p)|m[\\x5c'\"]*(?:o[\\x5c'\"]*r[\\x5c'\"]*e|a)|d[\\x5c'\"]*i[\\x5c'\"]*f[\\x5c'\"]*f|l[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*s)|e[\\x5c'\"]*s[\\x5c'\"]*s[\\x5c'\"]*(?:(?:f[\\x5c'\"]*i[\\x5c'\"]*l|p[\\x5c'\"]*i[\\x5c'\"]*p)[\\x5c'\"]*e|e[\\x5c'\"]*c[\\x5c'\"]*h[\\x5c'\"]*o|(?:\\s|<|>).*)|a[\\x5c'\"]*s[\\x5c'\"]*t[\\x5c'\"]*(?:l[\\x5c'\"]*o[\\x5c'\"]*g(?:[\\x5c'\"]*i[\\x5c'\"]*n)?|c[\\x5c'\"]*o[\\x5c'\"]*m[\\x5c'\"]*m|(?:\\s|<|>).*)|o[\\x5c'\"]*(?:c[\\x5c'\"]*a[\\x5c'\"]*(?:t[\\x5c'\"]*e|l)[\\x5c'\"]*(?:\\s|<|>).*|g[\\x5c'\"]*n[\\x5c'\"]*a[\\x5c'\"]*m[\\x5c'\"]*e)|d[\\x5c'\"]*(?:c[\\x5c'\"]*o[\\x5c'\"]*n[\\x5c'\"]*f[\\x5c'\"]*i[\\x5c'\"]*g|d[\\x5c'\"]*(?:\\s|<|>).*)|(?:[np]|i[\\x5c'\"]*n[\\x5c'\"]*k[\\x5c'\"]*s|y[\\x5c'\"]*n[\\x5c'\"]*x)[\\x5c'\"]*(?:\\s|<|>).*|u[\\x5c'\"]*a[\\x5c'\"]*(?:5[\\x5c'\"]*\\.[\\x5c'\"]*[1234]|(?:\\s|<|>).*)|f[\\x5c'\"]*t[\\x5c'\"]*p(?:[\\x5c'\"]*g[\\x5c'\"]*e[\\x5c'\"]*t)?)|b[\\x5c'\"]*(?:z[\\x5c'\"]*(?:(?:[ef][\\x5c'\"]*)?g[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*p|d[\\x5c'\"]*i[\\x5c'\"]*f[\\x5c'\"]*f|l[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*s|m[\\x5c'\"]*o[\\x5c'\"]*r[\\x5c'\"]*e|c[\\x5c'\"]*a[\\x5c'\"]*t|i[\\x5c'\"]*p[\\x5c'\"]*2)|s[\\x5c'\"]*d[\\x5c'\"]*(?:c[\\x5c'\"]*a[\\x5c'\"]*t|i[\\x5c'\"]*f[\\x5c'\"]*f|t[\\x5c'\"]*a[\\x5c'\"]*r)|a[\\x5c'\"]*(?:t[\\x5c'\"]*c[\\x5c'\"]*h[\\x5c'\"]*(?:\\s|<|>).*|s[\\x5c'\"]*h)|r[\\x5c'\"]*e[\\x5c'\"]*a[\\x5c'\"]*k[\\x5c'\"]*s[\\x5c'\"]*w|u[\\x5c'\"]*i[\\x5c'\"]*l[\\x5c'\"]*t[\\x5c'\"]*i[\\x5c'\"]*n)|f[\\x5c'\"]*(?:i(?:[\\x5c'\"]*(?:l[\\x5c'\"]*e[\\x5c'\"]*(?:t[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*t|(?:\\s|<|>).*)|n[\\x5c'\"]*d[\\x5c'\"]*(?:\\s|<|>).*|s[\\x5c'\"]*h))?|t[\\x5c'\"]*p[\\x5c'\"]*(?:s[\\x5c'\"]*t[\\x5c'\"]*a[\\x5c'\"]*t[\\x5c'\"]*s|w[\\x5c'\"]*h[\\x5c'\"]*o|(?:\\s|<|>).*)|u[\\x5c'\"]*n[\\x5c'\"]*c[\\x5c'\"]*t[\\x5c'\"]*i[\\x5c'\"]*o[\\x5c'\"]*n|(?:e[\\x5c'\"]*t[\\x5c'\"]*c[\\x5c'\"]*h|c)[\\x5c'\"]*(?:\\s|<|>).*|o[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*a[\\x5c'\"]*c[\\x5c'\"]*h|g[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*p)|c[\\x5c'\"]*(?:o[\\x5c'\"]*(?:m[\\x5c'\"]*(?:p[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*s|m[\\x5c'\"]*a[\\x5c'\"]*n[\\x5c'\"]*d)[\\x5c'\"]*(?:\\s|<|>).*|p[\\x5c'\"]*r[\\x5c'\"]*o[\\x5c'\"]*c)|h[\\x5c'\"]*(?:d[\\x5c'\"]*i[\\x5c'\"]*r[\\x5c'\"]*(?:\\s|<|>).*|f[\\x5c'\"]*l[\\x5c'\"]*a[\\x5c'\"]*g[\\x5c'\"]*s|a[\\x5c'\"]*t[\\x5c'\"]*t[\\x5c'\"]*r|m[\\x5c'\"]*o[\\x5c'\"]*d)|r[\\x5c'\"]*o[\\x5c'\"]*n[\\x5c'\"]*t[\\x5c'\"]*a[\\x5c'\"]*b|(?:[cp]|a[\\x5c'\"]*t)[\\x5c'\"]*(?:\\s|<|>).*|u[\\x5c'\"]*r[\\x5c'\"]*l|s[\\x5c'\"]*h)|e[\\x5c'\"]*(?:n[\\x5c'\"]*(?:v(?:[\\x5c'\"]*-[\\x5c'\"]*u[\\x5c'\"]*p[\\x5c'\"]*d[\\x5c'\"]*a[\\x5c'\"]*t[\\x5c'\"]*e)?|d[\\x5c'\"]*(?:i[\\x5c'\"]*f|s[\\x5c'\"]*w))|x[\\x5c'\"]*(?:p[\\x5c'\"]*(?:a[\\x5c'\"]*n[\\x5c'\"]*d|o[\\x5c'\"]*r[\\x5c'\"]*t|r)|e[\\x5c'\"]*c[\\x5c'\"]*(?:\\s|<|>).*)|c[\\x5c'\"]*h[\\x5c'\"]*o[\\x5c'\"]*(?:\\s|<|>).*|g[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*p|s[\\x5c'\"]*a[\\x5c'\"]*c|v[\\x5c'\"]*a[\\x5c'\"]*l)|h[\\x5c'\"]*(?:t[\\x5c'\"]*(?:d[\\x5c'\"]*i[\\x5c'\"]*g[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*t|p[\\x5c'\"]*a[\\x5c'\"]*s[\\x5c'\"]*s[\\x5c'\"]*w[\\x5c'\"]*d)|o[\\x5c'\"]*s[\\x5c'\"]*t[\\x5c'\"]*(?:n[\\x5c'\"]*a[\\x5c'\"]*m[\\x5c'\"]*e|i[\\x5c'\"]*d)|(?:e[\\x5c'\"]*a[\\x5c'\"]*d|u[\\x5c'\"]*p)[\\x5c'\"]*(?:\\s|<|>).*|i[\\x5c'\"]*s[\\x5c'\"]*t[\\x5c'\"]*o[\\x5c'\"]*r[\\x5c'\"]*y)|i[\\x5c'\"]*(?:p[\\x5c'\"]*(?:(?:6[\\x5c'\"]*)?t[\\x5c'\"]*a[\\x5c'\"]*b[\\x5c'\"]*l[\\x5c'\"]*e[\\x5c'\"]*s|c[\\x5c'\"]*o[\\x5c'\"]*n[\\x5c'\"]*f[\\x5c'\"]*i[\\x5c'\"]*g)|r[\\x5c'\"]*b(?:[\\x5c'\"]*(?:2[\\x5c'\"]*[01234567]|1(?:[\\x5c'\"]*[89])?|3[\\x5c'\"]*0))?|f[\\x5c'\"]*c[\\x5c'\"]*o[\\x5c'\"]*n[\\x5c'\"]*f[\\x5c'\"]*i[\\x5c'\"]*g|d[\\x5c'\"]*(?:\\s|<|>).*)|a[\\x5c'\"]*(?:l[\\x5c'\"]*(?:i[\\x5c'\"]*a[\\x5c'\"]*s[\\x5c'\"]*(?:\\s|<|>).*|p[\\x5c'\"]*i[\\x5c'\"]*n[\\x5c'\"]*e)|d[\\x5c'\"]*d[\\x5c'\"]*u[\\x5c'\"]*s[\\x5c'\"]*e[\\x5c'\"]*r|p[\\x5c'\"]*t[\\x5c'\"]*-[\\x5c'\"]*g[\\x5c'\"]*e[\\x5c'\"]*t|r[\\x5c'\"]*(?:c[\\x5c'\"]*h[\\x5c'\"]*(?:\\s|<|>).*|p)|w[\\x5c'\"]*[ks][\\x5c'\"]*(?:\\s|<|>).*)|g[\\x5c'\"]*(?:(?:e[\\x5c'\"]*t[\\x5c'\"]*f[\\x5c'\"]*a[\\x5c'\"]*c[\\x5c'\"]*l|r[\\x5c'\"]*e[\\x5c'\"]*p|c[\\x5c'\"]*c|i[\\x5c'\"]*t|o)[\\x5c'\"]*(?:\\s|<|>).*|z[\\x5c'\"]*(?:c[\\x5c'\"]*a[\\x5c'\"]*t|i[\\x5c'\"]*p)|u[\\x5c'\"]*n[\\x5c'\"]*z[\\x5c'\"]*i[\\x5c'\"]*p|d[\\x5c'\"]*b)|d[\\x5c'\"]*(?:h[\\x5c'\"]*c[\\x5c'\"]*l[\\x5c'\"]*i[\\x5c'\"]*e[\\x5c'\"]*n[\\x5c'\"]*t|(?:i[\\x5c'\"]*f[\\x5c'\"]*f|u)[\\x5c'\"]*(?:\\s|<|>).*|(?:m[\\x5c'\"]*e[\\x5c'\"]*s|p[\\x5c'\"]*k)[\\x5c'\"]*g|o[\\x5c'\"]*(?:a[\\x5c'\"]*s|n[\\x5c'\"]*e)|a[\\x5c'\"]*s[\\x5c'\"]*h)|m[\\x5c'\"]*(?:(?:k[\\x5c'\"]*d[\\x5c'\"]*i[\\x5c'\"]*r|o[\\x5c'\"]*r[\\x5c'\"]*e)[\\x5c'\"]*(?:\\s|<|>).*|a[\\x5c'\"]*i[\\x5c'\"]*l[\\x5c'\"]*(?:x[\\x5c'\"]*(?:\\s|<|>).*|q)|l[\\x5c'\"]*o[\\x5c'\"]*c[\\x5c'\"]*a[\\x5c'\"]*t[\\x5c'\"]*e)|j[\\x5c'\"]*(?:(?:a[\\x5c'\"]*v[\\x5c'\"]*a|o[\\x5c'\"]*b[\\x5c'\"]*s)[\\x5c'\"]*(?:\\s|<|>).*|e[\\x5c'\"]*x[\\x5c'\"]*e[\\x5c'\"]*c)|k[\\x5c'\"]*(?:i[\\x5c'\"]*l[\\x5c'\"]*l[\\x5c'\"]*(?:a[\\x5c'\"]*l[\\x5c'\"]*l|(?:\\s|<|>).*)|s[\\x5c'\"]*h)|G[\\x5c'\"]*E[\\x5c'\"]*T[\\x5c'\"]*(?:\\s|<|>).*|7[\\x5c'\"]*z(?:[\\x5c'\"]*[ar])?)\\b",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-unix",
            "attack-rce",
            "paranoia-level/1",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL1",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932105",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Unix Command Injection",
         "operator" : "REGEX",
         "pattern" : "(?:;|\\{|\\||\\|\\||&|&&|\\n|\\r|\\$\\(|\\$\\(\\(|`|\\${|<\\(|>\\(|\\(\\s*\\))\\s*(?:{|\\s*\\(\\s*|\\w+=(?:[^\\s]*|\\$.*|\\$.*|<.*|>.*|\\'.*\\'|\".*\")\\s+|!\\s*|\\$)*\\s*(?:'|\")*(?:[\\?\\*\\[\\]\\(\\)\\-\\|+\\w'\"\\./\\x5c]+/)?[\\x5c'\"]*(?:s[\\x5c'\"]*(?:e[\\x5c'\"]*(?:t[\\x5c'\"]*(?:(?:f[\\x5c'\"]*a[\\x5c'\"]*c[\\x5c'\"]*l[\\x5c'\"]*)?(?:\\s|<|>).*|e[\\x5c'\"]*n[\\x5c'\"]*v|s[\\x5c'\"]*i[\\x5c'\"]*d)|n[\\x5c'\"]*d[\\x5c'\"]*m[\\x5c'\"]*a[\\x5c'\"]*i[\\x5c'\"]*l|d[\\x5c'\"]*(?:\\s|<|>).*)|h[\\x5c'\"]*(?:\\.[\\x5c'\"]*d[\\x5c'\"]*i[\\x5c'\"]*s[\\x5c'\"]*t[\\x5c'\"]*r[\\x5c'\"]*i[\\x5c'\"]*b|u[\\x5c'\"]*t[\\x5c'\"]*d[\\x5c'\"]*o[\\x5c'\"]*w[\\x5c'\"]*n|(?:\\s|<|>).*)|o[\\x5c'\"]*(?:(?:u[\\x5c'\"]*r[\\x5c'\"]*c[\\x5c'\"]*e|r[\\x5c'\"]*t)[\\x5c'\"]*(?:\\s|<|>).*|c[\\x5c'\"]*a[\\x5c'\"]*t)|c[\\x5c'\"]*(?:h[\\x5c'\"]*e[\\x5c'\"]*d|p[\\x5c'\"]*(?:\\s|<|>).*)|t[\\x5c'\"]*r[\\x5c'\"]*i[\\x5c'\"]*n[\\x5c'\"]*g[\\x5c'\"]*s|(?:l[\\x5c'\"]*e[\\x5c'\"]*e|f[\\x5c'\"]*t)[\\x5c'\"]*p|y[\\x5c'\"]*s[\\x5c'\"]*c[\\x5c'\"]*t[\\x5c'\"]*l|u[\\x5c'\"]*(?:(?:\\s|<|>).*|d[\\x5c'\"]*o)|d[\\x5c'\"]*i[\\x5c'\"]*f[\\x5c'\"]*f|s[\\x5c'\"]*h|v[\\x5c'\"]*n)|p[\\x5c'\"]*(?:k[\\x5c'\"]*(?:g(?:(?:[\\x5c'\"]*_)?[\\x5c'\"]*i[\\x5c'\"]*n[\\x5c'\"]*f[\\x5c'\"]*o)?|e[\\x5c'\"]*x[\\x5c'\"]*e[\\x5c'\"]*c|i[\\x5c'\"]*l[\\x5c'\"]*l)|t[\\x5c'\"]*a[\\x5c'\"]*r(?:[\\x5c'\"]*(?:d[\\x5c'\"]*i[\\x5c'\"]*f[\\x5c'\"]*f|g[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*p))?|a[\\x5c'\"]*(?:t[\\x5c'\"]*c[\\x5c'\"]*h[\\x5c'\"]*(?:\\s|<|>).*|s[\\x5c'\"]*s[\\x5c'\"]*w[\\x5c'\"]*d)|r[\\x5c'\"]*i[\\x5c'\"]*n[\\x5c'\"]*t[\\x5c'\"]*(?:e[\\x5c'\"]*n[\\x5c'\"]*v|f[\\x5c'\"]*(?:\\s|<|>).*)|y[\\x5c'\"]*t[\\x5c'\"]*h[\\x5c'\"]*o[\\x5c'\"]*n(?:[\\x5c'\"]*(?:3(?:[\\x5c'\"]*m)?|2))?|e[\\x5c'\"]*r[\\x5c'\"]*(?:l(?:[\\x5c'\"]*(?:s[\\x5c'\"]*h|5))?|m[\\x5c'\"]*s)|(?:u[\\x5c'\"]*s[\\x5c'\"]*h|o[\\x5c'\"]*p)[\\x5c'\"]*d|f[\\x5c'\"]*(?:(?:\\s|<|>).*|t[\\x5c'\"]*p)|g[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*p|h[\\x5c'\"]*p(?:[\\x5c'\"]*[57])?|i[\\x5c'\"]*n[\\x5c'\"]*g|s[\\x5c'\"]*(?:\\s|<|>).*)|n[\\x5c'\"]*(?:c[\\x5c'\"]*(?:\\.[\\x5c'\"]*(?:t[\\x5c'\"]*r[\\x5c'\"]*a[\\x5c'\"]*d[\\x5c'\"]*i[\\x5c'\"]*t[\\x5c'\"]*i[\\x5c'\"]*o[\\x5c'\"]*n[\\x5c'\"]*a[\\x5c'\"]*l|o[\\x5c'\"]*p[\\x5c'\"]*e[\\x5c'\"]*n[\\x5c'\"]*b[\\x5c'\"]*s[\\x5c'\"]*d)|(?:\\s|<|>).*|a[\\x5c'\"]*t)|e[\\x5c'\"]*t[\\x5c'\"]*(?:k[\\x5c'\"]*i[\\x5c'\"]*t[\\x5c'\"]*-[\\x5c'\"]*f[\\x5c'\"]*t[\\x5c'\"]*p|(?:s[\\x5c'\"]*t|c)[\\x5c'\"]*a[\\x5c'\"]*t|(?:\\s|<|>).*)|s[\\x5c'\"]*(?:l[\\x5c'\"]*o[\\x5c'\"]*o[\\x5c'\"]*k[\\x5c'\"]*u[\\x5c'\"]*p|t[\\x5c'\"]*a[\\x5c'\"]*t)|(?:a[\\x5c'\"]*n[\\x5c'\"]*o|i[\\x5c'\"]*c[\\x5c'\"]*e)[\\x5c'\"]*(?:\\s|<|>).*|(?:o[\\x5c'\"]*h[\\x5c'\"]*u|m[\\x5c'\"]*a)[\\x5c'\"]*p|p[\\x5c'\"]*i[\\x5c'\"]*n[\\x5c'\"]*g)|r[\\x5c'\"]*(?:e[\\x5c'\"]*(?:(?:p[\\x5c'\"]*(?:l[\\x5c'\"]*a[\\x5c'\"]*c[\\x5c'\"]*e|e[\\x5c'\"]*a[\\x5c'\"]*t)|n[\\x5c'\"]*a[\\x5c'\"]*m[\\x5c'\"]*e)[\\x5c'\"]*(?:\\s|<|>).*|a[\\x5c'\"]*l[\\x5c'\"]*p[\\x5c'\"]*a[\\x5c'\"]*t[\\x5c'\"]*h)|m[\\x5c'\"]*(?:(?:d[\\x5c'\"]*i[\\x5c'\"]*r[\\x5c'\"]*)?(?:\\s|<|>).*|u[\\x5c'\"]*s[\\x5c'\"]*e[\\x5c'\"]*r)|u[\\x5c'\"]*b[\\x5c'\"]*y(?:[\\x5c'\"]*(?:1(?:[\\x5c'\"]*[89])?|2[\\x5c'\"]*[012]))?|(?:c[\\x5c'\"]*p|p[\\x5c'\"]*m)[\\x5c'\"]*(?:\\s|<|>).*|a[\\x5c'\"]*(?:r[\\x5c'\"]*(?:\\s|<|>).*|k[\\x5c'\"]*u)|n[\\x5c'\"]*a[\\x5c'\"]*n[\\x5c'\"]*o|o[\\x5c'\"]*u[\\x5c'\"]*t[\\x5c'\"]*e|s[\\x5c'\"]*y[\\x5c'\"]*n[\\x5c'\"]*c)|t[\\x5c'\"]*(?:c[\\x5c'\"]*(?:p[\\x5c'\"]*(?:t[\\x5c'\"]*r[\\x5c'\"]*a[\\x5c'\"]*c[\\x5c'\"]*e[\\x5c'\"]*r[\\x5c'\"]*o[\\x5c'\"]*u[\\x5c'\"]*t[\\x5c'\"]*e|i[\\x5c'\"]*n[\\x5c'\"]*g)|s[\\x5c'\"]*h)|r[\\x5c'\"]*a[\\x5c'\"]*c[\\x5c'\"]*e[\\x5c'\"]*r[\\x5c'\"]*o[\\x5c'\"]*u[\\x5c'\"]*t[\\x5c'\"]*e(?:[\\x5c'\"]*6)?|e[\\x5c'\"]*(?:l[\\x5c'\"]*n[\\x5c'\"]*e[\\x5c'\"]*t|e[\\x5c'\"]*(?:\\s|<|>).*)|i[\\x5c'\"]*m[\\x5c'\"]*e[\\x5c'\"]*(?:o[\\x5c'\"]*u[\\x5c'\"]*t|(?:\\s|<|>).*)|a[\\x5c'\"]*(?:i[\\x5c'\"]*l(?:[\\x5c'\"]*f)?|r[\\x5c'\"]*(?:\\s|<|>).*)|o[\\x5c'\"]*(?:u[\\x5c'\"]*c[\\x5c'\"]*h[\\x5c'\"]*(?:\\s|<|>).*|p))|u[\\x5c'\"]*(?:n[\\x5c'\"]*(?:l[\\x5c'\"]*(?:i[\\x5c'\"]*n[\\x5c'\"]*k[\\x5c'\"]*(?:\\s|<|>).*|z[\\x5c'\"]*m[\\x5c'\"]*a)|c[\\x5c'\"]*o[\\x5c'\"]*m[\\x5c'\"]*p[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*s|a[\\x5c'\"]*m[\\x5c'\"]*e|r[\\x5c'\"]*a[\\x5c'\"]*r|s[\\x5c'\"]*e[\\x5c'\"]*t|z[\\x5c'\"]*i[\\x5c'\"]*p|x[\\x5c'\"]*z)|s[\\x5c'\"]*e[\\x5c'\"]*r[\\x5c'\"]*(?:(?:a[\\x5c'\"]*d|m[\\x5c'\"]*o)[\\x5c'\"]*d|d[\\x5c'\"]*e[\\x5c'\"]*l)|l[\\x5c'\"]*i[\\x5c'\"]*m[\\x5c'\"]*i[\\x5c'\"]*t[\\x5c'\"]*(?:\\s|<|>).*)|m[\\x5c'\"]*(?:y[\\x5c'\"]*s[\\x5c'\"]*q[\\x5c'\"]*l(?:[\\x5c'\"]*(?:d[\\x5c'\"]*u[\\x5c'\"]*m[\\x5c'\"]*p(?:[\\x5c'\"]*s[\\x5c'\"]*l[\\x5c'\"]*o[\\x5c'\"]*w)?|h[\\x5c'\"]*o[\\x5c'\"]*t[\\x5c'\"]*c[\\x5c'\"]*o[\\x5c'\"]*p[\\x5c'\"]*y|a[\\x5c'\"]*d[\\x5c'\"]*m[\\x5c'\"]*i[\\x5c'\"]*n|s[\\x5c'\"]*h[\\x5c'\"]*o[\\x5c'\"]*w))?|(?:(?:o[\\x5c'\"]*u[\\x5c'\"]*n|u[\\x5c'\"]*t)[\\x5c'\"]*t|v)[\\x5c'\"]*(?:\\s|<|>).*)|x[\\x5c'\"]*(?:z[\\x5c'\"]*(?:(?:[ef][\\x5c'\"]*)?g[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*p|d[\\x5c'\"]*(?:i[\\x5c'\"]*f[\\x5c'\"]*f|e[\\x5c'\"]*c)|c[\\x5c'\"]*(?:a[\\x5c'\"]*t|m[\\x5c'\"]*p)|l[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*s|m[\\x5c'\"]*o[\\x5c'\"]*r[\\x5c'\"]*e|(?:\\s|<|>).*)|a[\\x5c'\"]*r[\\x5c'\"]*g[\\x5c'\"]*s|t[\\x5c'\"]*e[\\x5c'\"]*r[\\x5c'\"]*m|x[\\x5c'\"]*d[\\x5c'\"]*(?:\\s|<|>).*)|z[\\x5c'\"]*(?:(?:[ef][\\x5c'\"]*)?g[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*p|c[\\x5c'\"]*(?:a[\\x5c'\"]*t|m[\\x5c'\"]*p)|d[\\x5c'\"]*i[\\x5c'\"]*f[\\x5c'\"]*f|i[\\x5c'\"]*p[\\x5c'\"]*(?:\\s|<|>).*|l[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*s|m[\\x5c'\"]*o[\\x5c'\"]*r[\\x5c'\"]*e|r[\\x5c'\"]*u[\\x5c'\"]*n|s[\\x5c'\"]*h)|o[\\x5c'\"]*(?:p[\\x5c'\"]*e[\\x5c'\"]*n[\\x5c'\"]*s[\\x5c'\"]*s[\\x5c'\"]*l|n[\\x5c'\"]*i[\\x5c'\"]*n[\\x5c'\"]*t[\\x5c'\"]*r)|w[\\x5c'\"]*(?:h[\\x5c'\"]*o[\\x5c'\"]*(?:a[\\x5c'\"]*m[\\x5c'\"]*i|(?:\\s|<|>).*)|g[\\x5c'\"]*e[\\x5c'\"]*t|3[\\x5c'\"]*m)|v[\\x5c'\"]*i[\\x5c'\"]*(?:m[\\x5c'\"]*(?:\\s|<|>).*|g[\\x5c'\"]*r|p[\\x5c'\"]*w)|y[\\x5c'\"]*u[\\x5c'\"]*m)\\b",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-unix",
            "attack-rce",
            "paranoia-level/1",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL1",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932110",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Windows Command Injection",
         "operator" : "REGEX",
         "pattern" : "(?i)(?:;|\\{|\\||\\|\\||&|&&|\\n|\\r|`)\\s*[\\(,@\\'\"\\s]*(?:[\\w'\"\\./]+/|[\\x5c'\"\\^]*\\w[\\x5c'\"\\^]*:.*\\x5c|[\\^\\.\\w '\"/\\x5c]*\\x5c)?[\"\\^]*(?:m[\"\\^]*(?:y[\"\\^]*s[\"\\^]*q[\"\\^]*l(?:[\"\\^]*(?:d[\"\\^]*u[\"\\^]*m[\"\\^]*p(?:[\"\\^]*s[\"\\^]*l[\"\\^]*o[\"\\^]*w)?|h[\"\\^]*o[\"\\^]*t[\"\\^]*c[\"\\^]*o[\"\\^]*p[\"\\^]*y|a[\"\\^]*d[\"\\^]*m[\"\\^]*i[\"\\^]*n|s[\"\\^]*h[\"\\^]*o[\"\\^]*w))?|s[\"\\^]*(?:i[\"\\^]*(?:n[\"\\^]*f[\"\\^]*o[\"\\^]*3[\"\\^]*2|e[\"\\^]*x[\"\\^]*e[\"\\^]*c)|c[\"\\^]*o[\"\\^]*n[\"\\^]*f[\"\\^]*i[\"\\^]*g|g[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|t[\"\\^]*s[\"\\^]*c)|o[\"\\^]*(?:u[\"\\^]*n[\"\\^]*t[\"\\^]*(?:(?:[\\s,;]|\\.|/|<|>).*|v[\"\\^]*o[\"\\^]*l)|v[\"\\^]*e[\"\\^]*u[\"\\^]*s[\"\\^]*e[\"\\^]*r|[dr][\"\\^]*e[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*)|k[\"\\^]*(?:d[\"\\^]*i[\"\\^]*r[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|l[\"\\^]*i[\"\\^]*n[\"\\^]*k)|d[\"\\^]*(?:s[\"\\^]*c[\"\\^]*h[\"\\^]*e[\"\\^]*d|(?:[\\s,;]|\\.|/|<|>).*)|a[\"\\^]*p[\"\\^]*i[\"\\^]*s[\"\\^]*e[\"\\^]*n[\"\\^]*d|b[\"\\^]*s[\"\\^]*a[\"\\^]*c[\"\\^]*l[\"\\^]*i|e[\"\\^]*a[\"\\^]*s[\"\\^]*u[\"\\^]*r[\"\\^]*e|m[\"\\^]*s[\"\\^]*y[\"\\^]*s)|d[\"\\^]*(?:i[\"\\^]*(?:s[\"\\^]*k[\"\\^]*(?:(?:m[\"\\^]*g[\"\\^]*m|p[\"\\^]*a[\"\\^]*r)[\"\\^]*t|s[\"\\^]*h[\"\\^]*a[\"\\^]*d[\"\\^]*o[\"\\^]*w)|r[\"\\^]*(?:(?:[\\s,;]|\\.|/|<|>).*|u[\"\\^]*s[\"\\^]*e)|f[\"\\^]*f[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*)|e[\"\\^]*(?:l[\"\\^]*(?:p[\"\\^]*r[\"\\^]*o[\"\\^]*f|t[\"\\^]*r[\"\\^]*e[\"\\^]*e|(?:[\\s,;]|\\.|/|<|>).*)|v[\"\\^]*(?:m[\"\\^]*g[\"\\^]*m[\"\\^]*t|c[\"\\^]*o[\"\\^]*n)|(?:f[\"\\^]*r[\"\\^]*a|b[\"\\^]*u)[\"\\^]*g)|s[\"\\^]*(?:a[\"\\^]*(?:c[\"\\^]*l[\"\\^]*s|d[\"\\^]*d)|q[\"\\^]*u[\"\\^]*e[\"\\^]*r[\"\\^]*y|m[\"\\^]*o[\"\\^]*(?:v[\"\\^]*e|d)|g[\"\\^]*e[\"\\^]*t|r[\"\\^]*m)|(?:r[\"\\^]*i[\"\\^]*v[\"\\^]*e[\"\\^]*r[\"\\^]*q[\"\\^]*u[\"\\^]*e[\"\\^]*r|o[\"\\^]*s[\"\\^]*k[\"\\^]*e)[\"\\^]*y|(?:c[\"\\^]*o[\"\\^]*m[\"\\^]*c[\"\\^]*n[\"\\^]*f|x[\"\\^]*d[\"\\^]*i[\"\\^]*a)[\"\\^]*g|a[\"\\^]*t[\"\\^]*e[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|n[\"\\^]*s[\"\\^]*s[\"\\^]*t[\"\\^]*a[\"\\^]*t)|c[\"\\^]*(?:o[\"\\^]*(?:m[\"\\^]*(?:p[\"\\^]*(?:(?:a[\"\\^]*c[\"\\^]*t[\"\\^]*)?(?:[\\s,;]|\\.|/|<|>).*|m[\"\\^]*g[\"\\^]*m[\"\\^]*t)|e[\"\\^]*x[\"\\^]*p)|n[\"\\^]*(?:2[\"\\^]*p|v[\"\\^]*e)[\"\\^]*r[\"\\^]*t|p[\"\\^]*y)|l[\"\\^]*(?:e[\"\\^]*a[\"\\^]*(?:n[\"\\^]*m[\"\\^]*g[\"\\^]*r|r[\"\\^]*m[\"\\^]*e[\"\\^]*m)|u[\"\\^]*s[\"\\^]*t[\"\\^]*e[\"\\^]*r)|h[\"\\^]*(?:k[\"\\^]*(?:n[\"\\^]*t[\"\\^]*f[\"\\^]*s|d[\"\\^]*s[\"\\^]*k)|d[\"\\^]*i[\"\\^]*r[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*)|s[\"\\^]*(?:c[\"\\^]*(?:r[\"\\^]*i[\"\\^]*p[\"\\^]*t|c[\"\\^]*m[\"\\^]*d)|v[\"\\^]*d[\"\\^]*e)|e[\"\\^]*r[\"\\^]*t[\"\\^]*(?:u[\"\\^]*t[\"\\^]*i[\"\\^]*l|r[\"\\^]*e[\"\\^]*q)|a[\"\\^]*(?:l[\"\\^]*l[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|c[\"\\^]*l[\"\\^]*s)|m[\"\\^]*d(?:[\"\\^]*k[\"\\^]*e[\"\\^]*y)?|i[\"\\^]*p[\"\\^]*h[\"\\^]*e[\"\\^]*r|u[\"\\^]*r[\"\\^]*l)|f[\"\\^]*(?:o[\"\\^]*r[\"\\^]*(?:m[\"\\^]*a[\"\\^]*t[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|f[\"\\^]*i[\"\\^]*l[\"\\^]*e[\"\\^]*s|e[\"\\^]*a[\"\\^]*c[\"\\^]*h)|i[\"\\^]*n[\"\\^]*d[\"\\^]*(?:(?:[\\s,;]|\\.|/|<|>).*|s[\"\\^]*t[\"\\^]*r)|s[\"\\^]*(?:m[\"\\^]*g[\"\\^]*m[\"\\^]*t|u[\"\\^]*t[\"\\^]*i[\"\\^]*l)|t[\"\\^]*(?:p[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|y[\"\\^]*p[\"\\^]*e)|r[\"\\^]*e[\"\\^]*e[\"\\^]*d[\"\\^]*i[\"\\^]*s[\"\\^]*k|c[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|g[\"\\^]*r[\"\\^]*e[\"\\^]*p)|n[\"\\^]*(?:e[\"\\^]*t[\"\\^]*(?:s[\"\\^]*(?:t[\"\\^]*a[\"\\^]*t|v[\"\\^]*c|h)|(?:[\\s,;]|\\.|/|<|>).*|c[\"\\^]*a[\"\\^]*t|d[\"\\^]*o[\"\\^]*m)|t[\"\\^]*(?:b[\"\\^]*a[\"\\^]*c[\"\\^]*k[\"\\^]*u[\"\\^]*p|r[\"\\^]*i[\"\\^]*g[\"\\^]*h[\"\\^]*t[\"\\^]*s)|(?:s[\"\\^]*l[\"\\^]*o[\"\\^]*o[\"\\^]*k[\"\\^]*u|m[\"\\^]*a)[\"\\^]*p|c[\"\\^]*(?:(?:[\\s,;]|\\.|/|<|>).*|a[\"\\^]*t)|b[\"\\^]*t[\"\\^]*s[\"\\^]*t[\"\\^]*a[\"\\^]*t)|e[\"\\^]*(?:x[\"\\^]*p[\"\\^]*(?:a[\"\\^]*n[\"\\^]*d[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|l[\"\\^]*o[\"\\^]*r[\"\\^]*e[\"\\^]*r)|v[\"\\^]*e[\"\\^]*n[\"\\^]*t[\"\\^]*(?:c[\"\\^]*r[\"\\^]*e[\"\\^]*a[\"\\^]*t[\"\\^]*e|v[\"\\^]*w[\"\\^]*r)|n[\"\\^]*d[\"\\^]*l[\"\\^]*o[\"\\^]*c[\"\\^]*a[\"\\^]*l|g[\"\\^]*r[\"\\^]*e[\"\\^]*p|r[\"\\^]*a[\"\\^]*s[\"\\^]*e|c[\"\\^]*h[\"\\^]*o)|g[\"\\^]*(?:a[\"\\^]*t[\"\\^]*h[\"\\^]*e[\"\\^]*r[\"\\^]*n[\"\\^]*e[\"\\^]*t[\"\\^]*w[\"\\^]*o[\"\\^]*r[\"\\^]*k[\"\\^]*i[\"\\^]*n[\"\\^]*f[\"\\^]*o|p[\"\\^]*(?:(?:r[\"\\^]*e[\"\\^]*s[\"\\^]*u[\"\\^]*l|e[\"\\^]*d[\"\\^]*i)[\"\\^]*t|u[\"\\^]*p[\"\\^]*d[\"\\^]*a[\"\\^]*t[\"\\^]*e)|i[\"\\^]*t[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|e[\"\\^]*t[\"\\^]*m[\"\\^]*a[\"\\^]*c)|i[\"\\^]*(?:r[\"\\^]*b(?:[\"\\^]*(?:1(?:[\"\\^]*[89])?|2[\"\\^]*[012]))?|f[\"\\^]*m[\"\\^]*e[\"\\^]*m[\"\\^]*b[\"\\^]*e[\"\\^]*r|p[\"\\^]*c[\"\\^]*o[\"\\^]*n[\"\\^]*f[\"\\^]*i[\"\\^]*g|n[\"\\^]*e[\"\\^]*t[\"\\^]*c[\"\\^]*p[\"\\^]*l|c[\"\\^]*a[\"\\^]*c[\"\\^]*l[\"\\^]*s)|a[\"\\^]*(?:d[\"\\^]*(?:d[\"\\^]*u[\"\\^]*s[\"\\^]*e[\"\\^]*r[\"\\^]*s|m[\"\\^]*o[\"\\^]*d[\"\\^]*c[\"\\^]*m[\"\\^]*d)|r[\"\\^]*p[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|t[\"\\^]*t[\"\\^]*r[\"\\^]*i[\"\\^]*b|s[\"\\^]*s[\"\\^]*o[\"\\^]*c|z[\"\\^]*m[\"\\^]*a[\"\\^]*n)|l[\"\\^]*(?:o[\"\\^]*g[\"\\^]*(?:e[\"\\^]*v[\"\\^]*e[\"\\^]*n[\"\\^]*t|t[\"\\^]*i[\"\\^]*m[\"\\^]*e|m[\"\\^]*a[\"\\^]*n|o[\"\\^]*f[\"\\^]*f)|a[\"\\^]*b[\"\\^]*e[\"\\^]*l[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|u[\"\\^]*s[\"\\^]*r[\"\\^]*m[\"\\^]*g[\"\\^]*r)|b[\"\\^]*(?:(?:c[\"\\^]*d[\"\\^]*(?:b[\"\\^]*o[\"\\^]*o|e[\"\\^]*d[\"\\^]*i)|r[\"\\^]*o[\"\\^]*w[\"\\^]*s[\"\\^]*t[\"\\^]*a)[\"\\^]*t|i[\"\\^]*t[\"\\^]*s[\"\\^]*a[\"\\^]*d[\"\\^]*m[\"\\^]*i[\"\\^]*n|o[\"\\^]*o[\"\\^]*t[\"\\^]*c[\"\\^]*f[\"\\^]*g)|h[\"\\^]*(?:o[\"\\^]*s[\"\\^]*t[\"\\^]*n[\"\\^]*a[\"\\^]*m[\"\\^]*e|d[\"\\^]*w[\"\\^]*w[\"\\^]*i[\"\\^]*z)|j[\"\\^]*a[\"\\^]*v[\"\\^]*a[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|7[\"\\^]*z(?:[\"\\^]*[ar])?)(?:\\.[\"\\^]*\\w+)?\\b",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-windows",
            "attack-rce",
            "paranoia-level/1",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL1",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932115",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Windows Command Injection",
         "operator" : "REGEX",
         "pattern" : "(?i)(?:;|\\{|\\||\\|\\||&|&&|\\n|\\r|`)\\s*[\\(,@\\'\"\\s]*(?:[\\w'\"\\./]+/|[\\x5c'\"\\^]*\\w[\\x5c'\"\\^]*:.*\\x5c|[\\^\\.\\w '\"/\\x5c]*\\x5c)?[\"\\^]*(?:s[\"\\^]*(?:y[\"\\^]*s[\"\\^]*(?:t[\"\\^]*e[\"\\^]*m[\"\\^]*(?:p[\"\\^]*r[\"\\^]*o[\"\\^]*p[\"\\^]*e[\"\\^]*r[\"\\^]*t[\"\\^]*i[\"\\^]*e[\"\\^]*s[\"\\^]*(?:d[\"\\^]*a[\"\\^]*t[\"\\^]*a[\"\\^]*e[\"\\^]*x[\"\\^]*e[\"\\^]*c[\"\\^]*u[\"\\^]*t[\"\\^]*i[\"\\^]*o[\"\\^]*n[\"\\^]*p[\"\\^]*r[\"\\^]*e[\"\\^]*v[\"\\^]*e[\"\\^]*n[\"\\^]*t[\"\\^]*i[\"\\^]*o[\"\\^]*n|(?:p[\"\\^]*e[\"\\^]*r[\"\\^]*f[\"\\^]*o[\"\\^]*r[\"\\^]*m[\"\\^]*a[\"\\^]*n[\"\\^]*c|h[\"\\^]*a[\"\\^]*r[\"\\^]*d[\"\\^]*w[\"\\^]*a[\"\\^]*r)[\"\\^]*e|a[\"\\^]*d[\"\\^]*v[\"\\^]*a[\"\\^]*n[\"\\^]*c[\"\\^]*e[\"\\^]*d)|i[\"\\^]*n[\"\\^]*f[\"\\^]*o)|k[\"\\^]*e[\"\\^]*y|d[\"\\^]*m)|h[\"\\^]*(?:o[\"\\^]*(?:w[\"\\^]*(?:g[\"\\^]*r[\"\\^]*p|m[\"\\^]*b[\"\\^]*r)[\"\\^]*s|r[\"\\^]*t[\"\\^]*c[\"\\^]*u[\"\\^]*t)|e[\"\\^]*l[\"\\^]*l[\"\\^]*r[\"\\^]*u[\"\\^]*n[\"\\^]*a[\"\\^]*s|u[\"\\^]*t[\"\\^]*d[\"\\^]*o[\"\\^]*w[\"\\^]*n|r[\"\\^]*p[\"\\^]*u[\"\\^]*b[\"\\^]*w|a[\"\\^]*r[\"\\^]*e|i[\"\\^]*f[\"\\^]*t)|e[\"\\^]*(?:t[\"\\^]*(?:(?:x[\"\\^]*)?(?:[\\s,;]|\\.|/|<|>).*|l[\"\\^]*o[\"\\^]*c[\"\\^]*a[\"\\^]*l)|c[\"\\^]*p[\"\\^]*o[\"\\^]*l|l[\"\\^]*e[\"\\^]*c[\"\\^]*t)|c[\"\\^]*(?:h[\"\\^]*t[\"\\^]*a[\"\\^]*s[\"\\^]*k[\"\\^]*s|l[\"\\^]*i[\"\\^]*s[\"\\^]*t)|u[\"\\^]*b[\"\\^]*(?:i[\"\\^]*n[\"\\^]*a[\"\\^]*c[\"\\^]*l|s[\"\\^]*t)|(?:t[\"\\^]*a|o)[\"\\^]*r[\"\\^]*t[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|i[\"\\^]*g[\"\\^]*v[\"\\^]*e[\"\\^]*r[\"\\^]*i[\"\\^]*f|l[\"\\^]*(?:e[\"\\^]*e[\"\\^]*p|m[\"\\^]*g[\"\\^]*r)|f[\"\\^]*c|v[\"\\^]*n)|p[\"\\^]*(?:s[\"\\^]*(?:s[\"\\^]*(?:h[\"\\^]*u[\"\\^]*t[\"\\^]*d[\"\\^]*o[\"\\^]*w[\"\\^]*n|e[\"\\^]*r[\"\\^]*v[\"\\^]*i[\"\\^]*c[\"\\^]*e|u[\"\\^]*s[\"\\^]*p[\"\\^]*e[\"\\^]*n[\"\\^]*d)|l[\"\\^]*(?:o[\"\\^]*g[\"\\^]*(?:g[\"\\^]*e[\"\\^]*d[\"\\^]*o[\"\\^]*n|l[\"\\^]*i[\"\\^]*s[\"\\^]*t)|i[\"\\^]*s[\"\\^]*t)|p[\"\\^]*(?:a[\"\\^]*s[\"\\^]*s[\"\\^]*w[\"\\^]*d|i[\"\\^]*n[\"\\^]*g)|g[\"\\^]*e[\"\\^]*t[\"\\^]*s[\"\\^]*i[\"\\^]*d|e[\"\\^]*x[\"\\^]*e[\"\\^]*c|f[\"\\^]*i[\"\\^]*l[\"\\^]*e|i[\"\\^]*n[\"\\^]*f[\"\\^]*o|k[\"\\^]*i[\"\\^]*l[\"\\^]*l)|o[\"\\^]*(?:w[\"\\^]*e[\"\\^]*r[\"\\^]*(?:s[\"\\^]*h[\"\\^]*e[\"\\^]*l[\"\\^]*l(?:[\"\\^]*_[\"\\^]*i[\"\\^]*s[\"\\^]*e)?|c[\"\\^]*f[\"\\^]*g)|r[\"\\^]*t[\"\\^]*q[\"\\^]*r[\"\\^]*y|p[\"\\^]*d)|r[\"\\^]*(?:i[\"\\^]*n[\"\\^]*t[\"\\^]*(?:(?:[\\s,;]|\\.|/|<|>).*|b[\"\\^]*r[\"\\^]*m)|n[\"\\^]*(?:c[\"\\^]*n[\"\\^]*f[\"\\^]*g|m[\"\\^]*n[\"\\^]*g[\"\\^]*r)|o[\"\\^]*m[\"\\^]*p[\"\\^]*t)|a[\"\\^]*t[\"\\^]*h[\"\\^]*(?:p[\"\\^]*i[\"\\^]*n[\"\\^]*g|(?:[\\s,;]|\\.|/|<|>).*)|e[\"\\^]*r[\"\\^]*(?:l(?:[\"\\^]*(?:s[\"\\^]*h|5))?|f[\"\\^]*m[\"\\^]*o[\"\\^]*n)|y[\"\\^]*t[\"\\^]*h[\"\\^]*o[\"\\^]*n(?:[\"\\^]*(?:3(?:[\"\\^]*m)?|2))?|k[\"\\^]*g[\"\\^]*m[\"\\^]*g[\"\\^]*r|h[\"\\^]*p(?:[\"\\^]*[57])?|u[\"\\^]*s[\"\\^]*h[\"\\^]*d|i[\"\\^]*n[\"\\^]*g)|r[\"\\^]*(?:e[\"\\^]*(?:(?:p[\"\\^]*l[\"\\^]*a[\"\\^]*c[\"\\^]*e|n(?:[\"\\^]*a[\"\\^]*m[\"\\^]*e)?|s[\"\\^]*e[\"\\^]*t)[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|g[\"\\^]*(?:s[\"\\^]*v[\"\\^]*r[\"\\^]*3[\"\\^]*2|e[\"\\^]*d[\"\\^]*i[\"\\^]*t|(?:[\\s,;]|\\.|/|<|>).*|i[\"\\^]*n[\"\\^]*i)|c[\"\\^]*(?:d[\"\\^]*i[\"\\^]*s[\"\\^]*c|o[\"\\^]*v[\"\\^]*e[\"\\^]*r)|k[\"\\^]*e[\"\\^]*y[\"\\^]*w[\"\\^]*i[\"\\^]*z)|u[\"\\^]*(?:n[\"\\^]*(?:d[\"\\^]*l[\"\\^]*l[\"\\^]*3[\"\\^]*2|a[\"\\^]*s)|b[\"\\^]*y[\"\\^]*(?:1(?:[\"\\^]*[89])?|2[\"\\^]*[012]))|a[\"\\^]*(?:s[\"\\^]*(?:p[\"\\^]*h[\"\\^]*o[\"\\^]*n[\"\\^]*e|d[\"\\^]*i[\"\\^]*a[\"\\^]*l)|r[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*)|m[\"\\^]*(?:(?:d[\"\\^]*i[\"\\^]*r[\"\\^]*)?(?:[\\s,;]|\\.|/|<|>).*|t[\"\\^]*s[\"\\^]*h[\"\\^]*a[\"\\^]*r[\"\\^]*e)|o[\"\\^]*(?:u[\"\\^]*t[\"\\^]*e[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|b[\"\\^]*o[\"\\^]*c[\"\\^]*o[\"\\^]*p[\"\\^]*y)|s[\"\\^]*(?:t[\"\\^]*r[\"\\^]*u[\"\\^]*i|y[\"\\^]*n[\"\\^]*c)|d[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*)|t[\"\\^]*(?:a[\"\\^]*(?:s[\"\\^]*k[\"\\^]*(?:k[\"\\^]*i[\"\\^]*l[\"\\^]*l|l[\"\\^]*i[\"\\^]*s[\"\\^]*t|s[\"\\^]*c[\"\\^]*h[\"\\^]*d|m[\"\\^]*g[\"\\^]*r)|k[\"\\^]*e[\"\\^]*o[\"\\^]*w[\"\\^]*n)|(?:i[\"\\^]*m[\"\\^]*e[\"\\^]*o[\"\\^]*u|p[\"\\^]*m[\"\\^]*i[\"\\^]*n[\"\\^]*i|e[\"\\^]*l[\"\\^]*n[\"\\^]*e|l[\"\\^]*i[\"\\^]*s)[\"\\^]*t|s[\"\\^]*(?:d[\"\\^]*i[\"\\^]*s[\"\\^]*c[\"\\^]*o|s[\"\\^]*h[\"\\^]*u[\"\\^]*t[\"\\^]*d)[\"\\^]*n|y[\"\\^]*p[\"\\^]*e[\"\\^]*(?:p[\"\\^]*e[\"\\^]*r[\"\\^]*f|(?:[\\s,;]|\\.|/|<|>).*)|r[\"\\^]*(?:a[\"\\^]*c[\"\\^]*e[\"\\^]*r[\"\\^]*t|e[\"\\^]*e))|w[\"\\^]*(?:i[\"\\^]*n[\"\\^]*(?:d[\"\\^]*i[\"\\^]*f[\"\\^]*f|m[\"\\^]*s[\"\\^]*d[\"\\^]*p|v[\"\\^]*a[\"\\^]*r|r[\"\\^]*[ms])|u[\"\\^]*(?:a[\"\\^]*(?:u[\"\\^]*c[\"\\^]*l[\"\\^]*t|p[\"\\^]*p)|s[\"\\^]*a)|s[\"\\^]*c[\"\\^]*(?:r[\"\\^]*i[\"\\^]*p[\"\\^]*t|u[\"\\^]*i)|e[\"\\^]*v[\"\\^]*t[\"\\^]*u[\"\\^]*t[\"\\^]*i[\"\\^]*l|m[\"\\^]*i[\"\\^]*(?:m[\"\\^]*g[\"\\^]*m[\"\\^]*t|c)|a[\"\\^]*i[\"\\^]*t[\"\\^]*f[\"\\^]*o[\"\\^]*r|h[\"\\^]*o[\"\\^]*a[\"\\^]*m[\"\\^]*i|g[\"\\^]*e[\"\\^]*t)|u[\"\\^]*(?:s[\"\\^]*(?:e[\"\\^]*r[\"\\^]*a[\"\\^]*c[\"\\^]*c[\"\\^]*o[\"\\^]*u[\"\\^]*n[\"\\^]*t[\"\\^]*c[\"\\^]*o[\"\\^]*n[\"\\^]*t[\"\\^]*r[\"\\^]*o[\"\\^]*l[\"\\^]*s[\"\\^]*e[\"\\^]*t[\"\\^]*t[\"\\^]*i[\"\\^]*n[\"\\^]*g[\"\\^]*s|r[\"\\^]*s[\"\\^]*t[\"\\^]*a[\"\\^]*t)|n[\"\\^]*(?:r[\"\\^]*a[\"\\^]*r|z[\"\\^]*i[\"\\^]*p))|q[\"\\^]*(?:u[\"\\^]*e[\"\\^]*r[\"\\^]*y[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|p[\"\\^]*r[\"\\^]*o[\"\\^]*c[\"\\^]*e[\"\\^]*s[\"\\^]*s|w[\"\\^]*i[\"\\^]*n[\"\\^]*s[\"\\^]*t[\"\\^]*a|g[\"\\^]*r[\"\\^]*e[\"\\^]*p)|o[\"\\^]*(?:d[\"\\^]*b[\"\\^]*c[\"\\^]*(?:a[\"\\^]*d[\"\\^]*3[\"\\^]*2|c[\"\\^]*o[\"\\^]*n[\"\\^]*f)|p[\"\\^]*e[\"\\^]*n[\"\\^]*f[\"\\^]*i[\"\\^]*l[\"\\^]*e[\"\\^]*s)|v[\"\\^]*(?:o[\"\\^]*l[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*|e[\"\\^]*r[\"\\^]*i[\"\\^]*f[\"\\^]*y)|x[\"\\^]*c[\"\\^]*(?:a[\"\\^]*c[\"\\^]*l[\"\\^]*s|o[\"\\^]*p[\"\\^]*y)|z[\"\\^]*i[\"\\^]*p[\"\\^]*(?:[\\s,;]|\\.|/|<|>).*)(?:\\.[\"\\^]*\\w+)?\\b",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-windows",
            "attack-rce",
            "paranoia-level/1",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL1",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932120",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Windows PowerShell Command Found",
         "operator" : "PM",
         "opts" : {
            "transform" : [
               "cmd_line"
            ]
         },
         "pattern" : [
            "powershell.exe",
            "Add-BitsFile",
            "Add-Computer",
            "Add-Content",
            "Add-History",
            "Add-Member",
            "Add-PSSnapin",
            "Add-Type",
            "Checkpoint-Computer",
            "Clear-Content",
            "Clear-EventLog",
            "Clear-History",
            "Clear-Item",
            "Clear-ItemProperty",
            "Clear-Variable",
            "Compare-Object",
            "Complete-BitsTransfer",
            "Complete-Transaction",
            "Connect-WSMan",
            "ConvertFrom-CSV",
            "ConvertFrom-SecureString",
            "ConvertFrom-StringData",
            "Convert-Path",
            "ConvertTo-CSV",
            "ConvertTo-Html",
            "ConvertTo-SecureString",
            "ConvertTo-XML",
            "Copy-Item",
            "Copy-ItemProperty",
            "Debug-Process",
            "Disable-ComputerRestore",
            "Disable-PSBreakpoint",
            "Disable-PSSessionConfiguration",
            "Disable-WSManCredSSP",
            "Disconnect-WSMan",
            "Enable-ComputerRestore",
            "Enable-PSBreakpoint",
            "Enable-PSRemoting",
            "Enable-PSSessionConfiguration",
            "Enable-WSManCredSSP",
            "Enter-PSSession",
            "Exit-PSSession",
            "Export-Alias",
            "Export-Clixml",
            "Export-Console",
            "Export-Counter",
            "Export-CSV",
            "Export-FormatData",
            "Export-ModuleMember",
            "Export-PSSession",
            "ForEach-Object",
            "Format-Custom",
            "Format-List",
            "Format-Table",
            "Format-Wide",
            "Get-Acl",
            "Get-Alias",
            "Get-AppLockerFileInformation",
            "Get-AppLockerPolicy",
            "Get-AuthenticodeSignature",
            "Get-BitsTransfer",
            "Get-ChildItem",
            "Get-Command",
            "Get-ComputerRestorePoint",
            "Get-Content",
            "Get-Counter",
            "Get-Credential",
            "Get-Culture",
            "Get-Event",
            "Get-EventLog",
            "Get-EventSubscriber",
            "Get-ExecutionPolicy",
            "Get-FormatData",
            "Get-History",
            "Get-Host",
            "Get-HotFix",
            "Get-Item",
            "Get-ItemProperty",
            "Get-Job",
            "Get-Location",
            "Get-Member",
            "Get-Module",
            "Get-PfxCertificate",
            "Get-Process",
            "Get-PSBreakpoint",
            "Get-PSCallStack",
            "Get-PSDrive",
            "Get-PSProvider",
            "Get-PSSession",
            "Get-PSSessionConfiguration",
            "Get-PSSnapin",
            "Get-Random",
            "Get-Service",
            "Get-TraceSource",
            "Get-Transaction",
            "Get-TroubleshootingPack",
            "Get-UICulture",
            "Get-Unique",
            "Get-Variable",
            "Get-WinEvent",
            "Get-WmiObject",
            "Get-WSManCredSSP",
            "Get-WSManInstance",
            "Group-Object",
            "Import-Alias",
            "Import-Clixml",
            "Import-Counter",
            "Import-CSV",
            "Import-LocalizedData",
            "Import-Module",
            "Import-PSSession",
            "Invoke-Command",
            "Invoke-Expression",
            "Invoke-History",
            "Invoke-Item",
            "Invoke-TroubleshootingPack",
            "Invoke-WebRequest",
            "Invoke-WmiMethod",
            "Invoke-WSManAction",
            "Join-Path",
            "Limit-EventLog",
            "Measure-Command",
            "Measure-Object",
            "Move-Item",
            "Move-ItemProperty",
            "New-Alias",
            "New-AppLockerPolicy",
            "New-Event",
            "New-EventLog",
            "New-Item",
            "New-ItemProperty",
            "New-Module",
            "New-ModuleManifest",
            "New-Object",
            "New-PSDrive",
            "New-PSSession",
            "New-PSSessionOption",
            "New-Service",
            "New-TimeSpan",
            "New-Variable",
            "New-WebServiceProxy",
            "New-WSManInstance",
            "New-WSManSessionOption",
            "Out-Default",
            "Out-File",
            "Out-GridView",
            "Out-Host",
            "Out-Null",
            "Out-Printer",
            "Out-String",
            "Pop-Location",
            "Push-Location",
            "Read-Host",
            "Receive-Job",
            "Register-EngineEvent",
            "Register-ObjectEvent",
            "Register-PSSessionConfiguration",
            "Register-WmiEvent",
            "Remove-BitsTransfer",
            "Remove-Computer",
            "Remove-Event",
            "Remove-EventLog",
            "Remove-Item",
            "Remove-ItemProperty",
            "Remove-Job",
            "Remove-Module",
            "Remove-PSBreakpoint",
            "Remove-PSDrive",
            "Remove-PSSession",
            "Remove-PSSnapin",
            "Remove-Variable",
            "Remove-WmiObject",
            "Remove-WSManInstance",
            "Rename-Item",
            "Rename-ItemProperty",
            "Reset-ComputerMachinePassword",
            "Resolve-Path",
            "Restart-Computer",
            "Restart-Service",
            "Restore-Computer",
            "Resume-BitsTransfer",
            "Resume-Service",
            "Select-Object",
            "Select-String",
            "Select-XML",
            "Send-MailMessage",
            "Set-Acl",
            "Set-Alias",
            "Set-AppLockerPolicy",
            "Set-AuthenticodeSignature",
            "Set-BitsTransfer",
            "Set-Content",
            "Set-Date",
            "Set-ExecutionPolicy",
            "Set-Item",
            "Set-ItemProperty",
            "Set-Location",
            "Set-PSBreakpoint",
            "Set-PSDebug",
            "Set-PSSessionConfiguration",
            "Set-Service",
            "Set-StrictMode",
            "Set-TraceSource",
            "Set-Variable",
            "Set-WmiInstance",
            "Set-WSManInstance",
            "Set-WSManQuickConfig",
            "Show-EventLog",
            "Sort-Object",
            "Split-Path",
            "Start-BitsTransfer",
            "Start-Job",
            "Start-Process",
            "Start-Service",
            "Start-Sleep",
            "Start-Transaction",
            "Start-Transcript",
            "Stop-Computer",
            "Stop-Job",
            "Stop-Process",
            "Stop-Service",
            "Stop-Transcript",
            "Suspend-BitsTransfer",
            "Suspend-Service",
            "Tee-Object",
            "Test-AppLockerPolicy",
            "Test-ComputerSecureChannel",
            "Test-Connection",
            "Test-ModuleManifest",
            "Test-Path",
            "Test-WSMan",
            "Trace-Command",
            "Undo-Transaction",
            "Unregister-Event",
            "Unregister-PSSessionConfiguration",
            "Update-FormatData",
            "Update-List",
            "Update-TypeData",
            "Use-Transaction",
            "Wait-Event",
            "Wait-Job",
            "Wait-Process",
            "Where-Object",
            "Write-Debug",
            "Write-Error",
            "Write-EventLog",
            "Write-Host",
            "Write-Output",
            "Write-Progress",
            "Write-Verbose",
            "Write-Warning",
            "-EncodedCommand",
            "-ExecutionPolicy",
            "-PSConsoleFile"
         ],
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "language-powershell",
            "platform-windows",
            "attack-rce",
            "paranoia-level/1",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL1",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932130",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Unix Shell Expression Found",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "cmd_line"
            ]
         },
         "pattern" : "(?:\\$(?:\\((?:\\(.*\\)|.*)\\)|\\{.*})|[<>]\\(.*\\))",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-unix",
            "attack-rce",
            "paranoia-level/1",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL1",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932140",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Windows FOR/IF Command Found",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "cmd_line"
            ]
         },
         "pattern" : "\\b(?:if(?:/i)?(?: not)?(?: exist\\b| defined\\b| errorlevel\\b| cmdextversion\\b|(?: |\\().*(?:\\bgeq\\b|\\bequ\\b|\\bneq\\b|\\bleq\\b|\\bgtr\\b|\\blss\\b|==))|for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)\\s?do)",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-windows",
            "attack-rce",
            "paranoia-level/1",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL1",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932150",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Direct Unix Command Execution",
         "operator" : "REGEX",
         "pattern" : "(?:^|=)\\s*(?:{|\\s*\\(\\s*|\\w+=(?:[^\\s]*|\\$.*|\\$.*|<.*|>.*|\\'.*\\'|\".*\")\\s+|!\\s*|\\$)*\\s*(?:'|\")*(?:[\\?\\*\\[\\]\\(\\)\\-\\|+\\w'\"\\./\\x5c]+/)?[\\x5c'\"]*(?:l[\\x5c'\"]*(?:s(?:[\\x5c'\"]*(?:b[\\x5c'\"]*_[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*l[\\x5c'\"]*e[\\x5c'\"]*a[\\x5c'\"]*s[\\x5c'\"]*e|c[\\x5c'\"]*p[\\x5c'\"]*u|m[\\x5c'\"]*o[\\x5c'\"]*d|p[\\x5c'\"]*c[\\x5c'\"]*i|u[\\x5c'\"]*s[\\x5c'\"]*b|-[\\x5c'\"]*F|o[\\x5c'\"]*f))?|z[\\x5c'\"]*(?:(?:[ef][\\x5c'\"]*)?g[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*p|c[\\x5c'\"]*(?:a[\\x5c'\"]*t|m[\\x5c'\"]*p)|m[\\x5c'\"]*(?:o[\\x5c'\"]*r[\\x5c'\"]*e|a)|d[\\x5c'\"]*i[\\x5c'\"]*f[\\x5c'\"]*f|l[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*s)|e[\\x5c'\"]*s[\\x5c'\"]*s[\\x5c'\"]*(?:(?:f[\\x5c'\"]*i[\\x5c'\"]*l|p[\\x5c'\"]*i[\\x5c'\"]*p)[\\x5c'\"]*e|e[\\x5c'\"]*c[\\x5c'\"]*h[\\x5c'\"]*o)|a[\\x5c'\"]*s[\\x5c'\"]*t[\\x5c'\"]*(?:l[\\x5c'\"]*o[\\x5c'\"]*g(?:[\\x5c'\"]*i[\\x5c'\"]*n)?|c[\\x5c'\"]*o[\\x5c'\"]*m[\\x5c'\"]*m)|w[\\x5c'\"]*p(?:[\\x5c'\"]*-[\\x5c'\"]*d[\\x5c'\"]*o[\\x5c'\"]*w[\\x5c'\"]*n[\\x5c'\"]*l[\\x5c'\"]*o[\\x5c'\"]*a[\\x5c'\"]*d)?|f[\\x5c'\"]*t[\\x5c'\"]*p(?:[\\x5c'\"]*g[\\x5c'\"]*e[\\x5c'\"]*t)?|y[\\x5c'\"]*n[\\x5c'\"]*x)|s[\\x5c'\"]*(?:e[\\x5c'\"]*(?:t[\\x5c'\"]*(?:e[\\x5c'\"]*n[\\x5c'\"]*v|s[\\x5c'\"]*i[\\x5c'\"]*d)|n[\\x5c'\"]*d[\\x5c'\"]*m[\\x5c'\"]*a[\\x5c'\"]*i[\\x5c'\"]*l|d)|h(?:[\\x5c'\"]*\\.[\\x5c'\"]*d[\\x5c'\"]*i[\\x5c'\"]*s[\\x5c'\"]*t[\\x5c'\"]*r[\\x5c'\"]*i[\\x5c'\"]*b)?|o[\\x5c'\"]*(?:u[\\x5c'\"]*r[\\x5c'\"]*c[\\x5c'\"]*e|c[\\x5c'\"]*a[\\x5c'\"]*t)|t[\\x5c'\"]*r[\\x5c'\"]*i[\\x5c'\"]*n[\\x5c'\"]*g[\\x5c'\"]*s|y[\\x5c'\"]*s[\\x5c'\"]*c[\\x5c'\"]*t[\\x5c'\"]*l|c[\\x5c'\"]*(?:h[\\x5c'\"]*e[\\x5c'\"]*d|p)|d[\\x5c'\"]*i[\\x5c'\"]*f[\\x5c'\"]*f|f[\\x5c'\"]*t[\\x5c'\"]*p|u[\\x5c'\"]*d[\\x5c'\"]*o|s[\\x5c'\"]*h|v[\\x5c'\"]*n)|p[\\x5c'\"]*(?:t[\\x5c'\"]*a[\\x5c'\"]*r(?:[\\x5c'\"]*(?:d[\\x5c'\"]*i[\\x5c'\"]*f[\\x5c'\"]*f|g[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*p))?|y[\\x5c'\"]*t[\\x5c'\"]*h[\\x5c'\"]*o[\\x5c'\"]*n(?:[\\x5c'\"]*(?:3(?:[\\x5c'\"]*m)?|2))?|k[\\x5c'\"]*(?:e[\\x5c'\"]*x[\\x5c'\"]*e[\\x5c'\"]*c|i[\\x5c'\"]*l[\\x5c'\"]*l)|r[\\x5c'\"]*i[\\x5c'\"]*n[\\x5c'\"]*t[\\x5c'\"]*e[\\x5c'\"]*n[\\x5c'\"]*v|(?:g[\\x5c'\"]*r[\\x5c'\"]*e|f[\\x5c'\"]*t)[\\x5c'\"]*p|e[\\x5c'\"]*r[\\x5c'\"]*l(?:[\\x5c'\"]*5)?|h[\\x5c'\"]*p(?:[\\x5c'\"]*[57])?|o[\\x5c'\"]*p[\\x5c'\"]*d)|n[\\x5c'\"]*(?:c(?:[\\x5c'\"]*(?:\\.[\\x5c'\"]*(?:t[\\x5c'\"]*r[\\x5c'\"]*a[\\x5c'\"]*d[\\x5c'\"]*i[\\x5c'\"]*t[\\x5c'\"]*i[\\x5c'\"]*o[\\x5c'\"]*n[\\x5c'\"]*a[\\x5c'\"]*l|o[\\x5c'\"]*p[\\x5c'\"]*e[\\x5c'\"]*n[\\x5c'\"]*b[\\x5c'\"]*s[\\x5c'\"]*d)|a[\\x5c'\"]*t))?|e[\\x5c'\"]*t[\\x5c'\"]*(?:k[\\x5c'\"]*i[\\x5c'\"]*t[\\x5c'\"]*-[\\x5c'\"]*f[\\x5c'\"]*t[\\x5c'\"]*p|(?:s[\\x5c'\"]*t|c)[\\x5c'\"]*a[\\x5c'\"]*t)|o[\\x5c'\"]*h[\\x5c'\"]*u[\\x5c'\"]*p|p[\\x5c'\"]*i[\\x5c'\"]*n[\\x5c'\"]*g|s[\\x5c'\"]*t[\\x5c'\"]*a[\\x5c'\"]*t)|t[\\x5c'\"]*(?:c[\\x5c'\"]*(?:p[\\x5c'\"]*(?:t[\\x5c'\"]*r[\\x5c'\"]*a[\\x5c'\"]*c[\\x5c'\"]*e[\\x5c'\"]*r[\\x5c'\"]*o[\\x5c'\"]*u[\\x5c'\"]*t[\\x5c'\"]*e|i[\\x5c'\"]*n[\\x5c'\"]*g)|s[\\x5c'\"]*h)|r[\\x5c'\"]*a[\\x5c'\"]*c[\\x5c'\"]*e[\\x5c'\"]*r[\\x5c'\"]*o[\\x5c'\"]*u[\\x5c'\"]*t[\\x5c'\"]*e(?:[\\x5c'\"]*6)?|(?:i[\\x5c'\"]*m[\\x5c'\"]*e[\\x5c'\"]*o[\\x5c'\"]*u|e[\\x5c'\"]*l[\\x5c'\"]*n[\\x5c'\"]*e)[\\x5c'\"]*t|a[\\x5c'\"]*(?:i[\\x5c'\"]*l(?:[\\x5c'\"]*f)?|r))|r[\\x5c'\"]*(?:e[\\x5c'\"]*(?:p[\\x5c'\"]*(?:l[\\x5c'\"]*a[\\x5c'\"]*c[\\x5c'\"]*e|e[\\x5c'\"]*a[\\x5c'\"]*t)|a[\\x5c'\"]*l[\\x5c'\"]*p[\\x5c'\"]*a[\\x5c'\"]*t[\\x5c'\"]*h|n[\\x5c'\"]*a[\\x5c'\"]*m[\\x5c'\"]*e)|u[\\x5c'\"]*b[\\x5c'\"]*y(?:[\\x5c'\"]*(?:1(?:[\\x5c'\"]*[89])?|2[\\x5c'\"]*[012]))?|m[\\x5c'\"]*(?:u[\\x5c'\"]*s[\\x5c'\"]*e|d[\\x5c'\"]*i)[\\x5c'\"]*r|n[\\x5c'\"]*a[\\x5c'\"]*n[\\x5c'\"]*o|s[\\x5c'\"]*y[\\x5c'\"]*n[\\x5c'\"]*c|c[\\x5c'\"]*p)|b[\\x5c'\"]*(?:z[\\x5c'\"]*(?:(?:[ef][\\x5c'\"]*)?g[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*p|d[\\x5c'\"]*i[\\x5c'\"]*f[\\x5c'\"]*f|l[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*s|m[\\x5c'\"]*o[\\x5c'\"]*r[\\x5c'\"]*e|c[\\x5c'\"]*a[\\x5c'\"]*t)|s[\\x5c'\"]*d[\\x5c'\"]*(?:c[\\x5c'\"]*a[\\x5c'\"]*t|i[\\x5c'\"]*f[\\x5c'\"]*f|t[\\x5c'\"]*a[\\x5c'\"]*r)|u[\\x5c'\"]*i[\\x5c'\"]*l[\\x5c'\"]*t[\\x5c'\"]*i[\\x5c'\"]*n|a[\\x5c'\"]*s[\\x5c'\"]*h)|m[\\x5c'\"]*(?:y[\\x5c'\"]*s[\\x5c'\"]*q[\\x5c'\"]*l[\\x5c'\"]*(?:d[\\x5c'\"]*u[\\x5c'\"]*m[\\x5c'\"]*p(?:[\\x5c'\"]*s[\\x5c'\"]*l[\\x5c'\"]*o[\\x5c'\"]*w)?|h[\\x5c'\"]*o[\\x5c'\"]*t[\\x5c'\"]*c[\\x5c'\"]*o[\\x5c'\"]*p[\\x5c'\"]*y|a[\\x5c'\"]*d[\\x5c'\"]*m[\\x5c'\"]*i[\\x5c'\"]*n|s[\\x5c'\"]*h[\\x5c'\"]*o[\\x5c'\"]*w)|l[\\x5c'\"]*o[\\x5c'\"]*c[\\x5c'\"]*a[\\x5c'\"]*t[\\x5c'\"]*e|a[\\x5c'\"]*i[\\x5c'\"]*l[\\x5c'\"]*q)|u[\\x5c'\"]*(?:n[\\x5c'\"]*(?:c[\\x5c'\"]*o[\\x5c'\"]*m[\\x5c'\"]*p[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*s|l[\\x5c'\"]*z[\\x5c'\"]*m[\\x5c'\"]*a|a[\\x5c'\"]*m[\\x5c'\"]*e|r[\\x5c'\"]*a[\\x5c'\"]*r|s[\\x5c'\"]*e[\\x5c'\"]*t|z[\\x5c'\"]*i[\\x5c'\"]*p|x[\\x5c'\"]*z)|s[\\x5c'\"]*e[\\x5c'\"]*r[\\x5c'\"]*(?:(?:a[\\x5c'\"]*d|m[\\x5c'\"]*o)[\\x5c'\"]*d|d[\\x5c'\"]*e[\\x5c'\"]*l))|x[\\x5c'\"]*(?:z(?:[\\x5c'\"]*(?:(?:[ef][\\x5c'\"]*)?g[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*p|d[\\x5c'\"]*(?:i[\\x5c'\"]*f[\\x5c'\"]*f|e[\\x5c'\"]*c)|c[\\x5c'\"]*(?:a[\\x5c'\"]*t|m[\\x5c'\"]*p)|l[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*s|m[\\x5c'\"]*o[\\x5c'\"]*r[\\x5c'\"]*e))?|a[\\x5c'\"]*r[\\x5c'\"]*g[\\x5c'\"]*s)|z[\\x5c'\"]*(?:(?:(?:[ef][\\x5c'\"]*)?g[\\x5c'\"]*r[\\x5c'\"]*e|i)[\\x5c'\"]*p|c[\\x5c'\"]*(?:a[\\x5c'\"]*t|m[\\x5c'\"]*p)|d[\\x5c'\"]*i[\\x5c'\"]*f[\\x5c'\"]*f|l[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*s|m[\\x5c'\"]*o[\\x5c'\"]*r[\\x5c'\"]*e|r[\\x5c'\"]*u[\\x5c'\"]*n|s[\\x5c'\"]*h)|f[\\x5c'\"]*(?:t[\\x5c'\"]*p[\\x5c'\"]*(?:s[\\x5c'\"]*t[\\x5c'\"]*a[\\x5c'\"]*t[\\x5c'\"]*s|w[\\x5c'\"]*h[\\x5c'\"]*o)|i[\\x5c'\"]*l[\\x5c'\"]*e[\\x5c'\"]*t[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*t|e[\\x5c'\"]*t[\\x5c'\"]*c[\\x5c'\"]*h|g[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*p)|c[\\x5c'\"]*(?:o[\\x5c'\"]*(?:m[\\x5c'\"]*m[\\x5c'\"]*a[\\x5c'\"]*n[\\x5c'\"]*d|p[\\x5c'\"]*r[\\x5c'\"]*o[\\x5c'\"]*c)|u[\\x5c'\"]*r[\\x5c'\"]*l|s[\\x5c'\"]*h|c)|e[\\x5c'\"]*(?:g[\\x5c'\"]*r[\\x5c'\"]*e[\\x5c'\"]*p|c[\\x5c'\"]*h[\\x5c'\"]*o|v[\\x5c'\"]*a[\\x5c'\"]*l|x[\\x5c'\"]*e[\\x5c'\"]*c|n[\\x5c'\"]*v)|d[\\x5c'\"]*(?:m[\\x5c'\"]*e[\\x5c'\"]*s[\\x5c'\"]*g|a[\\x5c'\"]*s[\\x5c'\"]*h|i[\\x5c'\"]*f[\\x5c'\"]*f|o[\\x5c'\"]*a[\\x5c'\"]*s)|g[\\x5c'\"]*(?:z[\\x5c'\"]*(?:c[\\x5c'\"]*a[\\x5c'\"]*t|i[\\x5c'\"]*p)|r[\\x5c'\"]*e[\\x5c'\"]*p|c[\\x5c'\"]*c)|j[\\x5c'\"]*(?:o[\\x5c'\"]*b[\\x5c'\"]*s[\\x5c'\"]*\\s+[\\x5c'\"]*-[\\x5c'\"]*x|a[\\x5c'\"]*v[\\x5c'\"]*a)|w[\\x5c'\"]*(?:h[\\x5c'\"]*o[\\x5c'\"]*a[\\x5c'\"]*m[\\x5c'\"]*i|g[\\x5c'\"]*e[\\x5c'\"]*t|3[\\x5c'\"]*m)|i[\\x5c'\"]*r[\\x5c'\"]*b(?:[\\x5c'\"]*(?:1(?:[\\x5c'\"]*[89])?|2[\\x5c'\"]*[012]))?|o[\\x5c'\"]*n[\\x5c'\"]*i[\\x5c'\"]*n[\\x5c'\"]*t[\\x5c'\"]*r|h[\\x5c'\"]*(?:e[\\x5c'\"]*a[\\x5c'\"]*d|u[\\x5c'\"]*p)|v[\\x5c'\"]*i[\\x5c'\"]*(?:g[\\x5c'\"]*r|p[\\x5c'\"]*w)|G[\\x5c'\"]*E[\\x5c'\"]*T)[\\x5c'\"]*(?:\\s|;|\\||&|<|>)",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-unix",
            "attack-rce",
            "paranoia-level/1",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL1",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932160",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Unix Shell Code Found",
         "operator" : "PM",
         "opts" : {
            "transform" : [
               "cmd_line",
               "normalise_path"
            ]
         },
         "pattern" : [
            "${CDPATH}",
            "${DIRSTACK}",
            "${HOME}",
            "${HOSTNAME}",
            "${IFS}",
            "${OLDPWD}",
            "${OSTYPE}",
            "${PATH}",
            "${PWD}",
            "$CDPATH",
            "$DIRSTACK",
            "$HOME",
            "$HOSTNAME",
            "$IFS",
            "$OLDPWD",
            "$OSTYPE",
            "$PATH",
            "$PWD",
            "bin/bash",
            "bin/cat",
            "bin/csh",
            "bin/dash",
            "bin/du",
            "bin/echo",
            "bin/grep",
            "bin/less",
            "bin/ls",
            "bin/mknod",
            "bin/more",
            "bin/nc",
            "bin/ps",
            "bin/rbash",
            "bin/sh",
            "bin/sleep",
            "bin/su",
            "bin/tcsh",
            "bin/uname",
            "dev/fd/",
            "dev/null",
            "dev/stderr",
            "dev/stdin",
            "dev/stdout",
            "dev/tcp/",
            "dev/udp/",
            "dev/zero",
            "etc/group",
            "etc/master.passwd",
            "etc/passwd",
            "etc/pwd.db",
            "etc/shadow",
            "etc/shells",
            "etc/spwd.db",
            "proc/self/",
            "usr/bin/awk",
            "usr/bin/base64",
            "usr/bin/cat",
            "usr/bin/cc",
            "usr/bin/clang",
            "usr/bin/clang++",
            "usr/bin/curl",
            "usr/bin/diff",
            "usr/bin/env",
            "usr/bin/fetch",
            "usr/bin/file",
            "usr/bin/find",
            "usr/bin/ftp",
            "usr/bin/gawk",
            "usr/bin/gcc",
            "usr/bin/head",
            "usr/bin/hexdump",
            "usr/bin/id",
            "usr/bin/less",
            "usr/bin/ln",
            "usr/bin/mkfifo",
            "usr/bin/more",
            "usr/bin/nc",
            "usr/bin/ncat",
            "usr/bin/nice",
            "usr/bin/nmap",
            "usr/bin/perl",
            "usr/bin/php",
            "usr/bin/php5",
            "usr/bin/php7",
            "usr/bin/php-cgi",
            "usr/bin/printf",
            "usr/bin/psed",
            "usr/bin/python",
            "usr/bin/python2",
            "usr/bin/python3",
            "usr/bin/ruby",
            "usr/bin/sed",
            "usr/bin/socat",
            "usr/bin/tail",
            "usr/bin/tee",
            "usr/bin/telnet",
            "usr/bin/top",
            "usr/bin/uname",
            "usr/bin/wget",
            "usr/bin/who",
            "usr/bin/whoami",
            "usr/bin/xargs",
            "usr/bin/xxd",
            "usr/bin/yes",
            "usr/local/bin/bash",
            "usr/local/bin/curl",
            "usr/local/bin/ncat",
            "usr/local/bin/nmap",
            "usr/local/bin/perl",
            "usr/local/bin/php",
            "usr/local/bin/python",
            "usr/local/bin/python2",
            "usr/local/bin/python3",
            "usr/local/bin/rbash",
            "usr/local/bin/ruby",
            "usr/local/bin/wget"
         ],
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-unix",
            "attack-rce",
            "paranoia-level/1",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL1",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932170",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Shellshock (CVE-2014-6271)",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode"
            ]
         },
         "pattern" : "^\\(\\s*\\)\\s+{",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-unix",
            "attack-rce",
            "paranoia-level/1",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "type" : "REQUEST_LINE"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL1",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932171",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Shellshock (CVE-2014-6271)",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "uri_decode_uni"
            ]
         },
         "pattern" : "^\\(\\s*\\)\\s+{",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-unix",
            "attack-rce",
            "paranoia-level/1",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "type" : "FILES_NAMES"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL1",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932180",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Restricted File Upload Attempt",
         "operator" : "PM",
         "pattern" : [
            ".htaccess",
            ".htdigest",
            ".htpasswd",
            "wp-config.php",
            "config.yml",
            "config_dev.yml",
            "config_prod.yml",
            "config_test.yml",
            "parameters.yml",
            "routing.yml",
            "security.yml",
            "services.yml",
            "default.settings.php",
            "settings.php",
            "settings.local.php",
            "local.xml",
            ".env"
         ],
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-rce",
            "paranoia-level/1",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "type" : "FILES"
            },
            {
               "parse" : [
                  "specific",
                  "X-Filename"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "specific",
                  "X_Filename"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "specific",
                  "X-File-Name"
               ],
               "type" : "REQUEST_HEADERS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "932013",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "2",
         "skip_after" : "END-REQUEST-932-APPLICATION-ATTACK-RCE",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "DETECTION_PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "932014",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "2",
         "skip_after" : "END-REQUEST-932-APPLICATION-ATTACK-RCE",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "DETECTION_PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL1",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932101",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Unix Command Injection",
         "operator" : "REGEX",
         "pattern" : "(?:;|\\{|\\||\\|\\||&|&&|\\n|\\r|\\$\\(|\\$\\(\\(|`|\\${|<\\(|>\\(|\\(\\s*\\))\\s*(?:{|\\s*\\(\\s*|\\w+=(?:[^\\s]*|\\$.*|\\$.*|<.*|>.*|\\'.*\\'|\".*\")\\s+|!\\s*|\\$)*\\s*(?:'|\")*(?:[\\?\\*\\[\\]\\(\\)\\-\\|+\\w'\"\\./\\x5c]+/)?[\\x5c'\"]*\\.\\s.*\\b",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-unix",
            "attack-rce",
            "paranoia-level/2",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE_PL2",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932131",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Unix Shell Expression Found",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "cmd_line"
            ]
         },
         "pattern" : "(?:\\$(?:\\((?:\\(.*\\)|.*)\\)|\\{.*})|[<>]\\(.*\\))",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-unix",
            "attack-rce",
            "paranoia-level/2",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "User-Agent"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "specific",
                  "Referer"
               ],
               "type" : "REQUEST_HEADERS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "CHAIN",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "932200_MATCHED_VAR_NAME",
                     "value" : "%{MATCHED_VAR_NAME}"
                  }
               }
            ]
         },
         "id" : "932200",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "lowercase",
               "uri_decode_uni"
            ]
         },
         "pattern" : "(?:[*?`\\x5c'][^/\\n]+/|\\$[({\\[#@!?*\\-_$a-zA-Z0-9]|/[^/]+?[*?`\\x5c'])",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-rce",
            "paranoia-level/2",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "CHAIN"
         },
         "id" : "932200",
         "operator" : "REFIND",
         "opts" : {
            "transform" : [
               "uri_decode_uni"
            ]
         },
         "pattern" : "/",
         "vars" : [
            {
               "type" : "MATCHED_VAR"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL2",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932200",
         "logdata" : "Matched Data: %{TX.0} found within %{TX.932200_MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "RCE Bypass Technique",
         "operator" : "REFIND",
         "opts" : {
            "transform" : [
               "uri_decode_uni"
            ]
         },
         "pattern" : "\\s",
         "vars" : [
            {
               "type" : "MATCHED_VAR"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL2",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932210",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: SQLite System Command Execution",
         "operator" : "REFIND",
         "opts" : {
            "transform" : [
               "escape_seq_decode",
               "compress_whitespace"
            ]
         },
         "pattern" : ";\\s*\\.\\s*(?:s(?:e(?:parator|lftest)|c(?:anstats|hema)|h(?:a3sum|ell|ow)|ystem|tats|ave)|t(?:estc(?:ase|trl)|ime(?:out|r)|ables|race)|e(?:x(?:p(?:lain|ert)|cel|it)|cho|qp)|p(?:r(?:o(?:gress|mpt)|int)|arameter)|d(?:b(?:config|info)|atabases|ump)|c(?:h(?:anges|eck)|lone|d)|i(?:mpo(?:ster|rt)|ndexes)|l(?:i(?:mi|n)t|o(?:ad|g))|b(?:a(?:ckup|il)|inary)|f(?:ullschema|ilectrl)|vfs(?:info|list|name)|re(?:cover|store|ad)|o(?:utput|nce|pen)|(?:nullvalu|mod)e|a(?:rchive|uth)|he(?:aders|lp)|width|quit)",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-unix",
            "attack-rce",
            "paranoia-level/2",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE_PL2",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932300",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: SMTP Command Execution",
         "operator" : "REFIND",
         "opts" : {
            "transform" : [
               "escape_seq_decode"
            ]
         },
         "pattern" : "(?is)\\r\\n.*?\\b(?:AUTH [A-Z0-9-_]{1,20} (?:=|(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=))|R(?:CPT TO:(?:<.{1,64}@.{1,255}>|(?: ))?<.{1,64}>|SET\\b)|VRFY (?:.{1,64} <.{1,64}@.{1,255}>|.{1,64}@.{1,255})|E(?:HLO [a-zA-Z-\\.]{1,255}|XPN (?:.{1,64}))|MAIL FROM:<.{1,64}@.{1,255}>|HELO [a-zA-Z-\\.]{1,255}|NOOP\\b(?: .{1,255})?|STARTTLS\\b)",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "platform-multi",
            "attack-rce",
            "paranoia-level/2",
            "OWASP_CRS",
            "capec/137/134",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE_PL2",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932310",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: IMAP Command Execution",
         "operator" : "REFIND",
         "opts" : {
            "transform" : [
               "escape_seq_decode"
            ]
         },
         "pattern" : "(?is)\\r\\n\\w{1,50}\\b[ ](?:A(?:PPEND (?:[\\w\"\\.\\-\\x5c\\/%\\*&#]+)?(?: \\((?:[a-z\\x5c\\ ])+\\))?(?: \"?\\d{1,2}-\\w{3}-\\d{4} \\d{2}:\\d{2}:\\d{2} [+-]\\d{4}\"?)? \\{\\d{1,20}\\+?}|UTHENTICATE [a-z0-9-_]{1,20}\\r\\n)|S(?:TATUS (?:[\\w\"\\.\\-\\x5c\\/%\\*&]+)? \\((?:UNSEEN|UIDNEXT|MESSAGES|UIDVALIDITY|RECENT| )+\\)|ETACL (?:[\\w\"\\.\\-\\x5c\\/%\\*&]+)? [+-][lrswipckdxtea]+?)|L(?:SUB (?:[\\w\"~\\/\\*#\\.]+)? (?:[\\w\"\\.\\x5c\\/%\\*&]+)?|ISTRIGHTS (?:[\\w\"\\.\\-\\x5c\\/%\\*&]+)?)|(?:(?:DELETE|GET)ACL|MYRIGHTS) (?:[\\w\"\\.\\-\\x5c\\/%\\*&]+)?|UID (?:COPY|FETCH|STORE) (?:[0-9,:\\*]+)?)",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "platform-multi",
            "attack-rce",
            "paranoia-level/2",
            "OWASP_CRS",
            "capec/137/134",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE_PL2",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932320",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: POP3 Command Execution",
         "operator" : "REFIND",
         "opts" : {
            "transform" : [
               "escape_seq_decode"
            ]
         },
         "pattern" : "(?si)\\r\\n.*?\\b(?:A(?:UTH [A-Z0-9-_]{1,20} (?:=|(?:[\\w+/]{4})*(?:[\\w+/]{2}==|[\\w+/]{3}=))|POP [\\w]+ [a-f0-9]{32})|(?:TOP \\d+|LIST)(?: \\d+)?|U(?:IDL(?: \\d+)?|SER .+?)|(?:DELE|RETR) \\d+?|PASS .+?)",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "platform-multi",
            "attack-rce",
            "paranoia-level/2",
            "OWASP_CRS",
            "capec/137/134",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "932015",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "3",
         "skip_after" : "END-REQUEST-932-APPLICATION-ATTACK-RCE",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "DETECTION_PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "932016",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "3",
         "skip_after" : "END-REQUEST-932-APPLICATION-ATTACK-RCE",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "DETECTION_PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL3",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932106",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Unix Command Injection",
         "operator" : "REGEX",
         "pattern" : "(?:;|\\{|\\||\\|\\||&|&&|\\n|\\r|\\$\\(|\\$\\(\\(|`|\\${|<\\(|>\\(|\\(\\s*\\))\\s*(?:{|\\s*\\(\\s*|\\w+=(?:[^\\s]*|\\$.*|\\$.*|<.*|>.*|\\'.*\\'|\".*\")\\s+|!\\s*|\\$)*\\s*(?:'|\")*(?:[\\?\\*\\[\\]\\(\\)\\-\\|+\\w'\"\\./\\x5c]+/)?[\\x5c'\"]*(?:(?:(?:a[\\x5c'\"]*p[\\x5c'\"]*t[\\x5c'\"]*i[\\x5c'\"]*t[\\x5c'\"]*u[\\x5c'\"]*d|u[\\x5c'\"]*p[\\x5c'\"]*2[\\x5c'\"]*d[\\x5c'\"]*a[\\x5c'\"]*t)[\\x5c'\"]*e|d[\\x5c'\"]*n[\\x5c'\"]*f|v[\\x5c'\"]*i)[\\x5c'\"]*(?:\\s|<|>).*|p[\\x5c'\"]*(?:a[\\x5c'\"]*c[\\x5c'\"]*m[\\x5c'\"]*a[\\x5c'\"]*n[\\x5c'\"]*(?:\\s|<|>).*|w[\\x5c'\"]*d|s)|w[\\x5c'\"]*(?:(?:\\s|<|>).*|h[\\x5c'\"]*o))\\b",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-unix",
            "attack-rce",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2",
            "paranoia-level/3"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL3",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932190",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: Wildcard bypass technique attempt",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "uri_decode_uni",
               "normalise_path",
               "cmd_line"
            ]
         },
         "pattern" : "/(?:[?*]+[a-z/]+|[a-z/]+[?*]+)",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-shell",
            "platform-unix",
            "attack-rce",
            "OWASP_CRS",
            "capec/1000/152/248/88",
            "PCI/6.5.2",
            "paranoia-level/3"
         ],
         "vars" : [
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL3",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932301",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: SMTP Command Execution",
         "operator" : "REFIND",
         "opts" : {
            "transform" : [
               "escape_seq_decode"
            ]
         },
         "pattern" : "(?s)\\r\\n.*?\\b(?:HELP(?: .{1,255})?|DATA|QUIT)",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "platform-multi",
            "attack-rce",
            "paranoia-level/3",
            "OWASP_CRS",
            "capec/137/134",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL3",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932311",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: IMAP Command Execution",
         "operator" : "REFIND",
         "opts" : {
            "transform" : [
               "escape_seq_decode"
            ]
         },
         "pattern" : "(?is)\\r\\n\\w{1,50}\\b[ ](?:S(?:E(?:ARCH(?: CHARSET [\\w\\-_\\.]{1,40})? (?:(KEYWORD \\x5c)?(?:ALL|ANSWERED|BCC|DELETED|DRAFT|FLAGGED|RECENT|SEEN|UNANSWERED|UNDELETED|UNDRAFT|UNFLAGGED|UNSEEN|NEW|OLD)|(?:TEXT .{1,255}|TO .{1,255}|UID [0-9,:\\*]+?|UNKEYWORD (?:\\x5c(Seen|Answered|Flagged|Deleted|Draft|Recent)))|(?:BEFORE|ON|SENTBEFORE|SENTON|SENTSINCE|SINCE) \"?\\d{1,2}-\\w{3}-\\d{4}\"?|(?:OR .{1,255} .{1,255}|SMALLER \\d{1,20}|SUBJECT .{1,255})|(?:(?:BODY|CC|FROM)|HEADER .{1,100}) .{1,255}|(?:LARGER \\d{1,20}|NOT .{1,255}|[0-9,:\\*]+))|LECT [\\w\"\\.\\-\\x5c\\/%\\*&#]+)|T(?:ORE [0-9,:\\*]+? [+-]?FLAGS(?:\\.SILENT)? (?:\\(\\x5c[a-z]{1,20}\\))?|ARTTLS)|UBSCRIBE [\\w\"\\.\\-\\x5c\\/%\\*&#]+)|L(?:IST [\\w\"~\\-\\x5c\\/\\*#\\.]+? [\\w\"\\.\\-\\x5c\\/%\\*&#]+|OG(?:IN [a-z0-9-_\\.\\@]{1,40} .*?|OUT))|C(?:(?:OPY [0-9,:\\*]+|REATE) [\\w\"\\.\\-\\x5c\\/%\\*&#]+|APABILITY|HECK|LOSE)|RENAME [\\w\"\\.\\-\\x5c\\/%\\*&#]+? [\\w\"\\.\\-\\x5c\\/%\\*&#]+|UN(?:SUBSCRIBE [\\w\"\\.\\-\\x5c\\/%\\*&#]+|AUTHENTICATE)|EX(?:AMINE [\\w\"\\.\\-\\x5c%\\*&#]+|PUNGE)|DELETE [\\w\"\\.\\-\\x5c%\\*&#]+|FETCH [0-9,:\\*]+|NOOP)",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "platform-multi",
            "attack-rce",
            "paranoia-level/3",
            "OWASP_CRS",
            "capec/137/134",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RCE_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "INBOUND_ANOMALY_SCORE_PL3",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               }
            ]
         },
         "id" : "932321",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Remote Command Execution: POP3 Command Execution",
         "operator" : "REFIND",
         "opts" : {
            "transform" : [
               "escape_seq_decode"
            ]
         },
         "pattern" : "(?si)\\r\\n.*?\\b(?:(?:QUI|RSE|STA)T|CAPA|NOOP)",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "platform-multi",
            "attack-rce",
            "paranoia-level/3",
            "OWASP_CRS",
            "capec/137/134",
            "PCI/6.5.2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/4.0.0-rc1"
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "932017",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "4",
         "skip_after" : "END-REQUEST-932-APPLICATION-ATTACK-RCE",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "DETECTION_PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "932018",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "4",
         "skip_after" : "END-REQUEST-932-APPLICATION-ATTACK-RCE",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "DETECTION_PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "DENY"
         },
         "id" : "END-REQUEST-932-APPLICATION-ATTACK-RCE",
         "op_negated" : 1,
         "vars" : [
            {
               "unconditional" : 1
            }
         ]
      }
   ],
   "body_filter" : [],
   "header_filter" : []
}

