{"access":[{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942100","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack Detected via libinjection","operator":"DETECT_SQLI","opts":{"transform":["utf8_to_unicode","uri_decode_uni","remove_nulls"]},"pattern":"","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["specific","User-Agent"],"type":"REQUEST_HEADERS"},{"parse":["specific","Referer"],"type":"REQUEST_HEADERS"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942140","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack: Common DB Names Detected","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)\\b(?:(?:m(?:s(?:ys(?:ac(?:cess(?:objects|storage|xml)|es)|(?:relationship|object|querie)s|modules2?)|db)|aster\\.\\.sysdatabases|ysql\\.db)|pg_(?:catalog|toast)|information_schema|northwind|tempdb)\\b|s(?:(?:ys(?:\\.database_name|aux)|qlite(?:_temp)?_master)\\b|chema(?:_name\\b|\\W*\\())|d(?:atabas|b_nam)e\\W*\\()","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942151","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack","operator":"REGEX","opts":{"transform":["uri_decode_uni","lowercase"]},"pattern":"(?i)\\b(?:c(?:o(?:n(?:v(?:ert(?:_tz)?)?|cat(?:_ws)?|nection_id)|(?:mpres)?s|ercibility|llation|alesce|t)|ur(?:rent_(?:time(?:stamp)?|date|user)|(?:dat|tim)e)|ha(?:racte)?r_length|iel(?:ing)?|r32)|s(?:t(?:d(?:dev_(?:sam|po)p)?|r(?:_to_date|cmp))|ub(?:str(?:ing(?:_index)?)?|(?:dat|tim)e)|e(?:ssion_user|c_to_time)|ys(?:tem_user|date)|ha[12]?|oundex|chema|pace|qrt|in)|i(?:s(?:_(?:ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|(?:free|used)_lock)|null)|n(?:et(?:6_(?:aton|ntoa)|_(?:aton|ntoa))|s(?:ert|tr)|terval)|fnull)|d(?:a(?:t(?:e(?:_(?:format|add|sub)|diff)|abase)|y(?:of(?:month|week|year)|name))|e(?:s_(?:de|en)crypt|grees|code)|count|ump)|l(?:o(?:ca(?:ltimestamp|te)|g(?:10|2)|ad_file|wer)|ast_(?:inser_id|day)|e(?:as|f)t|inestring|case|trim|pad)|t(?:ime(?:_(?:format|to_sec)|stamp(?:diff|add)?|diff)|o(?:(?:second|day)s|_base64|n?char)|r(?:uncate|im))|u(?:n(?:compress(?:ed_length)?|ix_timestamp|hex)|tc_(?:time(?:stamp)?|date)|uid(?:_short)?|pdatexml|case)|m(?:a(?:ke(?:_set|date)|ster_pos_wait)|ulti(?:po(?:lygon|int)|linestring)|i(?:crosecon)?d|onthname|d5)|g(?:e(?:t_(?:format|lock)|ometrycollection)|(?:r(?:oup_conca|eates)|tid_subse)t)|p(?:o(?:(?:siti|lyg)on|w)|eriod_(?:diff|add)|rocedure_analyse|g_sleep)|a(?:s(?:cii(?:str)?|in)|es_(?:de|en)crypt|dd(?:dat|tim)e|tan2?)|f(?:rom_(?:unixtime|base64|days)|i(?:el|n)d_in_set|ound_rows)|e(?:x(?:tract(?:value)?|p(?:ort_set)?)|nc(?:rypt|ode)|lt)|b(?:i(?:t_(?:length|count|x?or|and)|n_to_num)|enchmark)|r(?:a(?:wtohex|dians|nd)|elease_lock|ow_count|trim|pad)|o(?:(?:ld_passwo)?rd|ct(?:et_length)?)|we(?:ek(?:ofyear|day)|ight_string)|n(?:ame_const|ot_in|ullif)|var(?:_(?:sam|po)p|iance)|qu(?:arter|ote)|hex(?:toraw)?|yearweek|xmltype)\\W*\\(","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942160","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects blind sqli tests using sleep() or benchmark()","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i:sleep\\(\\s*?\\d*?\\s*?\\)|benchmark\\(.*?\\,.*?\\))","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66"],"vars":[{"type":"REQUEST_BASENAME"},{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942170","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects SQL benchmark and sleep injection attempts including conditional queries","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:select|;)\\s+(?:benchmark|sleep|if)\\s*?\\(\\s*?\\(?\\s*?\\w+","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942190","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects MSSQL code execution and information gathering attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni","remove_comments_char"]},"pattern":"(?i)(?:\\b(?:u(?:nion(?:[\\w(\\s]*?select|\\sselect\\s@)|ser\\s*?\\([^\\)]*?)|(?:c(?:onnection_id|urrent_user)|database)\\s*?\\([^\\)]*?|s(?:chema\\s*?\\([^\\)]*?|elect.*?\\w?user\\()|into[\\s+]+(?:dump|out)file\\s*?[\"'`]|from\\W+information_schema\\W|exec(?:ute)?\\s+master\\.)|[\"'`](?:;?\\s*?(?:union\\b\\s*?(?:(?:distin|sele)ct|all)|having|select)\\b\\s*?[^\\s]|\\s*?!\\s*?[\"'`\\w])|\\s*?exec(?:ute)?.*?\\Wxp_cmdshell|\\Wiif\\s*?\\()","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942220","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Looking for integer overflow attacks, these are taken from skipfish, except 2.2.2250738585072011e-308 is the \"magic number\" crash","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"^(?i:-0000023456|4294967295|4294967296|2147483648|2147483647|0000012345|-2147483648|-2147483649|0000023456|2.2250738585072007e-308|2.2250738585072011e-308|1e309)$","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942230","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects conditional SQL injection attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:select.*?having\\s*?[^\\s]+\\s*?[^\\w\\s]|[\\s()]case\\s+when.*?then|if\\s?\\(\\w+\\s*?[=<>~]|\\)\\s*?like\\s*?\\()","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942240","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects MySQL charset switch and MSSQL DoS attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:[\"'`](?:;*?\\s*?waitfor\\s+(?:delay|time)\\s+[\"'`]|;.*?:\\s*?goto)|alter\\s*?\\w+.*?cha(?:racte)?r\\s+set\\s+\\w+)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942250","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects MATCH AGAINST, MERGE and EXECUTE IMMEDIATE injections","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i:merge.*?using\\s*?\\(|execute\\s*?immediate\\s*?[\"'`]|match\\s*?[\\w(),+-]+\\s*?against\\s*?\\()","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942270","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Looking for basic sql injection. Common attack string for mysql, oracle and others","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)union.*?select.*?from","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942280","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects Postgres pg_sleep injection, waitfor delay attacks and database shutdown attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:;\\s*?shutdown\\s*?(?:[#;{]|\\/\\*|--)|waitfor\\s*?delay\\s?[\"'`]+\\s?\\d|select\\s*?pg_sleep)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942290","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Finds basic MongoDB SQL injection attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i:(?:\\[\\$(?:ne|eq|lte?|gte?|n?in|mod|all|size|exists|type|slice|x?or|div|like|between|and)\\]))","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942320","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects MySQL and PostgreSQL stored procedure/function injections","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:create\\s+(?:procedure|function)\\s*?\\w+\\s*?\\(\\s*?\\)\\s*?-|;\\s*?(?:declare|open)\\s+[\\w-]+|procedure\\s+analyse\\s*?\\(|declare[^\\w]+[@#]\\s*?\\w+|exec\\s*?\\(\\s*?@)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942350","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects MySQL UDF injection and other data/structure manipulation attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:;\\s*?(?:(?:(?:trunc|cre|upd)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|alter|load)\\b\\s*?[\\[(]?\\w{2,}|create\\s+function\\s.+\\sreturns)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942360","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects concatenated basic SQL injection and SQLLFI attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:^[\\W\\d]+\\s*?(?:alter\\s*(?:a(?:(?:pplication\\s*rol|ggregat)e|s(?:ymmetric\\s*ke|sembl)y|u(?:thorization|dit)|vailability\\s*group)|c(?:r(?:yptographic\\s*provider|edential)|o(?:l(?:latio|um)|nversio)n|ertificate|luster)|s(?:e(?:rv(?:ice|er)|curity|quence|ssion|arch)|y(?:mmetric\\s*key|nonym)|togroup|chema)|m(?:a(?:s(?:ter\\s*key|k)|terialized)|e(?:ssage\\s*type|thod)|odule)|l(?:o(?:g(?:file\\s*group|in)|ckdown)|a(?:ngua|r)ge|ibrary)|t(?:(?:abl(?:espac)?|yp)e|r(?:igger|usted)|hreshold|ext)|p(?:a(?:rtition|ckage)|ro(?:cedur|fil)e|ermission)|d(?:i(?:mension|skgroup)|atabase|efault|omain)|r(?:o(?:l(?:lback|e)|ute)|e(?:sourc|mot)e)|f(?:u(?:lltext|nction)|lashback|oreign)|e(?:xte(?:nsion|rnal)|(?:ndpoi|ve)nt)|in(?:dex(?:type)?|memory|stance)|b(?:roker\\s*priority|ufferpool)|x(?:ml\\s*schema|srobject)|w(?:ork(?:load)?|rapper)|hi(?:erarchy|stogram)|o(?:perator|utline)|(?:nicknam|queu)e|us(?:age|er)|group|java|view)\\b|(?:(?:(?:trunc|cre)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load)\\s+\\w+|u(?:nion\\s*(?:(?:distin|sele)ct|all)\\b|pdate\\s+\\w+))|\\b(?:(?:(?:(?:trunc|cre|upd)at|renam)e|(?:inser|selec)t|de(?:lete|sc)|alter|load)\\s+(?:group_concat|load_file|char)\\b\\s*\\(?|end\\s*?\\);)|[\"'`\\w]\\s+as\\b\\s*[\"'`\\w]+\\s*\\bfrom|[\\s(]load_file\\s*?\\(|[\"'`]\\s+regexp\\W)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942500","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"MySQL in-line comment detected","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i:/\\*[!+](?:[\\w\\s=_\\-()]+)?\\*/)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1}]}