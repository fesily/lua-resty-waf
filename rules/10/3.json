{"access":[{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933100","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: PHP Open Tag Found","operator":"REGEX","opts":{"transform":["lowercase"]},"pattern":"(?:<\\?(?:[^x]|x[^m]|xm[^l]|xml[^\\s]|xml$|$)|<\\?php|\\[(?:/|\\x5c)?php\\])","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933110","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: PHP Script File Upload Found","operator":"REGEX","opts":{"transform":["lowercase"]},"pattern":".*\\.(?:php\\d*|phtml)\\.*$","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"type":"FILES"},{"parse":["specific","X-Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X_Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X.Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X-File-Name"],"type":"REQUEST_HEADERS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933120","logdata":"Matched Data: %{TX.933120_TX_0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: Configuration Directive Found","operator":"PM","pattern":["="],"vars":[{"type":"MATCHED_VARS"}],"attack_tag":"attack-virtualpatch"},{"actions":{"disrupt":"CHAIN","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"933120_TX_0","value":"%{TX.0}"}}]},"id":"933120","operator":"PM","opts":{"transform":["normalise_path"]},"pattern":["allow_call_time_pass_reference","allow_url_fopen","allow_url_include","always_populate_raw_post_data","arg_separator.input","arg_separator.output","asp_tags","assert.active","assert.bail","assert.callback","assert.quiet_eval","assert.warning","auto_append_file","auto_detect_line_endings","auto_globals_jit","auto_prepend_file","bcmath.scale","birdstep.max_links","browscap","cgi.fix_pathinfo","cgi.force_redirect","cgi.nph","cgi.redirect_status_env","cgi.rfc2616_headers","com.allow_dcom","com.autoregister_casesensitive","com.autoregister_typelib","com.autoregister_verbose","com.code_page","com.typelib_file","date.default_latitude","date.default_longitude","date.sunrise_zenith","date.sunset_zenith","date.timezone","dba.default_handler","default_charset","default_mimetype","default_socket_timeout","define_syslog_variables","disable_classes","disable_functions","display_errors","display_startup_errors","doc_root","docref_ext","docref_root","enable_dl","error_append_string","error_log","error_prepend_string","error_reporting","exif.decode_jis_intel","exif.decode_jis_motorola","exif.decode_unicode_intel","exif.decode_unicode_motorola","exif.encode_jis","exif.encode_unicode","expose_php","extension_dir","fastcgi.impersonate","fastcgi.logging","file_uploads","filter.default","filter.default_flags","gd.jpeg_ignore_warning","highlight.bg","highlight.comment","highlight.default","highlight.html","highlight.keyword","highlight.string","html_errors","ibase.allow_persistent","ibase.dateformat","ibase.default_charset","ibase.default_db","ibase.default_password","ibase.default_user","ibase.max_links","ibase.max_persistent","ibase.timeformat","ibase.timestampformat","iconv.input_encoding","iconv.internal_encoding","iconv.output_encoding","ignore_repeated_errors","ignore_repeated_source","ignore_user_abort","implicit_flush","include_path","intl.default_locale","intl.error_level","ldap.max_links","log_errors","log_errors_max_len","magic_quotes_gpc","magic_quotes_runtime","magic_quotes_sybase","mail.add_x_header","mail.force_extra_parameters","mail.log","max_execution_time","max_file_uploads","max_input_nesting_level","max_input_time","mbstring.detect_order","mbstring.encoding_translation","mbstring.func_overload","mbstring.http_input","mbstring.http_output","mbstring.http_output_conv_mimetype","mbstring.internal_encoding","mbstring.language","mbstring.script_encoding","mbstring.strict_detection","mbstring.substitute_character","mcrypt.algorithms_dir","mcrypt.modes_dir","memory_limit","mssql.allow_persistent","mssql.batchsize","mssql.charset","mssql.compatability_mode","mssql.connect_timeout","mssql.datetimeconvert","mssql.max_links","mssql.max_persistent","mssql.max_procs","mssql.min_error_severity","mssql.min_message_severity","mssql.secure_connection","mssql.textlimit","mssql.textsize","mssql.timeout","mysql.allow_local_infile","mysql.allow_persistent","mysql.cache_size","mysql.connect_timeout","mysql.default_host","mysql.default_password","mysql.default_port","mysql.default_socket","mysql.default_user","mysql.max_links","mysql.max_persistent","mysql.trace_mode","mysqli.allow_local_infile","mysqli.allow_persistent","mysqli.cache_size","mysqli.default_host","mysqli.default_port","mysqli.default_pw","mysqli.default_socket","mysqli.default_user","mysqli.max_links","mysqli.max_persistent","mysqli.reconnect","mysqlnd.collect_memory_statistics","mysqlnd.collect_statistics","mysqlnd.net_cmd_buffer_size","mysqlnd.net_read_buffer_size","oci8.connection_class","oci8.default_prefetch","oci8.events","oci8.max_persistent","oci8.old_oci_close_semantics","oci8.persistent_timeout","oci8.ping_interval","oci8.privileged_connect","oci8.statement_cache_size","odbc.allow_persistent","odbc.check_persistent","odbc.default_db","odbc.default_pw","odbc.default_user","odbc.defaultbinmode","odbc.defaultlrl","odbc.max_links","odbc.max_persistent","open_basedir","output_buffering","output_handler","pcre.backtrack_limit","pcre.recursion_limit","pdo_mysql.cache_size","pdo_mysql.default_socket","pdo_odbc.connection_pooling","pgsql.allow_persistent","pgsql.auto_reset_persistent","pgsql.ignore_notice","pgsql.log_notice","pgsql.max_links","pgsql.max_persistent","phar.cache_list","phar.readonly","phar.require_hash","post_max_size","realpath_cache_size","realpath_cache_ttl","register_argc_argv","register_globals","register_long_arrays","report_memleaks","report_zend_debug","request_order","safe_mode","safe_mode_allowed_env_vars","safe_mode_exec_dir","safe_mode_gid","safe_mode_include_dir","safe_mode_protected_env_vars","sendmail_from","sendmail_path","serialize_precision","session.auto_start","session.bug_compat_42","session.bug_compat_warn","session.cache_expire","session.cache_limiter","session.cookie_domain","session.cookie_httponly","session.cookie_lifetime","session.cookie_path","session.cookie_secure","session.entropy_file","session.entropy_length","session.gc_divisor","session.gc_maxlifetime","session.gc_probability","session.hash_bits_per_character","session.hash_function","session.name","session.referer_check","session.save_handler","session.save_path","session.serialize_handler","session.use_cookies","session.use_only_cookies","session.use_trans_sid","short_open_tag","soap.wsdl_cache_dir","soap.wsdl_cache_enabled","soap.wsdl_cache_limit","soap.wsdl_cache_ttl","sql.safe_mode","sqlite.assoc_case","sqlite3.extension_dir","sybct.allow_persistent","sybct.deadlock_retry_count","sybct.hostname","sybct.login_timeout","sybct.max_links","sybct.max_persistent","sybct.min_client_severity","sybct.min_server_severity","sybct.timeout","sysvshm.init_mem","tidy.clean_output","tidy.default_config","track_errors","unserialize_callback_func","upload_max_filesize","upload_tmp_dir","url_rewriter.tags","user_agent","user_dir","user_ini.cache_ttl","user_ini.filename","variables_order","xmlrpc_error_number","xmlrpc_errors","y2k_compliance","zlib.output_compression","zlib.output_compression_level","zlib.output_handler"],"severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933130","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: Variables Found","operator":"PM","opts":{"transform":["normalise_path","uri_decode_uni"]},"pattern":["$GLOBALS","$HTTP_COOKIE_VARS","$HTTP_ENV_VARS","$HTTP_GET_VARS","$HTTP_POST_FILES","$HTTP_POST_VARS","$HTTP_RAW_POST_DATA","$HTTP_REQUEST_VARS","$HTTP_SERVER_VARS","$_COOKIE","$_ENV","$_FILES","$_GET","$_POST","$_REQUEST","$_SERVER","$_SESSION","$argc","$argv"],"severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933140","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: I/O Stream Found","operator":"REGEX","pattern":"(?i)php://(?:std(?:in|out|err)|(?:in|out)put|fd|memory|temp|filter)","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933200","logdata":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}","msg":"PHP Injection Attack: Wrapper scheme detected","operator":"REFIND","opts":{"transform":["utf8_to_unicode","uri_decode_uni","remove_nulls","cmd_line"]},"pattern":"(?i:zlib|glob|phar|ssh2|rar|ogg|expect|zip)://","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933160","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: High-Risk PHP Function Call Found","operator":"REGEX","pattern":"(?i)\\b(?:s(?:e(?:t(?:_(?:e(?:xception|rror)_handler|magic_quotes_runtime|include_path)|defaultstub)|ssion_s(?:et_save_handler|tart))|qlite_(?:(?:(?:unbuffered|single|array)_)?query|create_(?:aggregate|function)|p?open|exec)|tr(?:eam_(?:context_create|socket_client)|ipc?slashes|rev)|implexml_load_(?:string|file)|ocket_c(?:onnect|reate)|h(?:ow_sourc|a1_fil)e|pl_autoload_register|ystem)|p(?:r(?:eg_(?:replace(?:_callback(?:_array)?)?|match(?:_all)?|split)|oc_(?:(?:terminat|clos|nic)e|get_status|open)|int_r)|o(?:six_(?:get(?:(?:e[gu]|g)id|login|pwnam)|mk(?:fifo|nod)|ttyname|kill)|pen)|hp(?:_(?:strip_whitespac|unam)e|version|info)|g_(?:(?:execut|prepar)e|connect|query)|a(?:rse_(?:ini_file|str)|ssthru)|utenv)|r(?:unkit_(?:function_(?:re(?:defin|nam)e|copy|add)|method_(?:re(?:defin|nam)e|copy|add)|constant_(?:redefine|add))|e(?:(?:gister_(?:shutdown|tick)|name)_function|ad(?:(?:gz)?file|_exif_data|dir))|awurl(?:de|en)code)|i(?:mage(?:createfrom(?:(?:jpe|pn)g|x[bp]m|wbmp|gif)|(?:jpe|pn)g|g(?:d2?|if)|2?wbmp|xbm)|s_(?:(?:(?:execut|write?|read)ab|fi)le|dir)|ni_(?:get(?:_all)?|set)|terator_apply|ptcembed)|g(?:et(?:_(?:c(?:urrent_use|fg_va)r|meta_tags)|my(?:[gpu]id|inode)|(?:lastmo|cw)d|imagesize|env)|z(?:(?:(?:defla|wri)t|encod|fil)e|compress|open|read)|lob)|a(?:rray_(?:u(?:intersect(?:_u?assoc)?|diff(?:_u?assoc)?)|intersect_u(?:assoc|key)|diff_u(?:assoc|key)|filter|reduce|map)|ssert(?:_options)?)|h(?:tml(?:specialchars(?:_decode)?|_entity_decode|entities)|(?:ash(?:_(?:update|hmac))?|ighlight)_file|e(?:ader_register_callback|x2bin))|f(?:i(?:le(?:(?:[acm]tim|inod)e|(?:_exist|perm)s|group)?|nfo_open)|tp_(?:nb_(?:ge|pu)|connec|ge|pu)t|(?:unction_exis|pu)ts|write|open)|o(?:b_(?:get_(?:c(?:ontents|lean)|flush)|end_(?:clean|flush)|clean|flush|start)|dbc_(?:result(?:_all)?|exec(?:ute)?|connect)|pendir)|m(?:b_(?:ereg(?:_(?:replace(?:_callback)?|match)|i(?:_replace)?)?|parse_str)|(?:ove_uploaded|d5)_file|ethod_exists|ysql_query|kdir)|e(?:x(?:if_(?:t(?:humbnail|agname)|imagetype|read_data)|ec)|scapeshell(?:arg|cmd)|rror_reporting|val)|c(?:url_(?:file_create|exec|init)|onvert_uuencode|reate_function|hr)|u(?:n(?:serialize|pack)|rl(?:de|en)code|[ak]?sort)|(?:json_(?:de|en)cod|debug_backtrac|tmpfil)e|b(?:(?:son_(?:de|en)|ase64_en)code|zopen)|var_dump)(?:\\s|/\\*.*\\*/|//.*|#.*)*\\(.*\\)","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"type":"URI"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933170","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: Serialized Object Injection","operator":"REGEX","pattern":"[oOcC]:\\d+:\".+?\":\\d+:{.*}","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["values","1"],"type":"REQUEST_HEADERS"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933180","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: Variable Function Call Found","operator":"REGEX","pattern":"\\$+(?:[a-zA-Z_\\x7f-\\xff][a-zA-Z0-9_\\x7f-\\xff]*|\\s*{.+})(?:\\s|\\[.+\\]|{.+}|/\\*.*\\*/|//.*|#.*)*\\(.*\\)","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"type":"URI"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933210","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: Variable Function Call Found","operator":"REGEX","opts":{"transform":["uri_decode","replace_comments","remove_whitespace"]},"pattern":"(\\(.+\\)\\(.+\\)|\\(.+\\)['\"][a-zA-Z-_0-9]+['\"]\\(.+\\)|\\[\\d+\\]\\(.+\\)|\\{\\d+\\}\\(.+\\)|\\$[^(\\),.;\\x5c/]+\\(.+\\)|[\"'][a-zA-Z0-9-_\\x5c]+[\"']\\(.+\\)|\\([^\\)]*string[^\\)]*\\)[a-zA-Z-_0-9\"'.{}\\[\\]\\s]+\\([^\\)]*\\));","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"type":"URI"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942100","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack Detected via libinjection","operator":"DETECT_SQLI","opts":{"transform":["utf8_to_unicode","uri_decode_uni","remove_nulls"]},"pattern":"","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["specific","User-Agent"],"type":"REQUEST_HEADERS"},{"parse":["specific","Referer"],"type":"REQUEST_HEADERS"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942140","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack: Common DB Names Detected","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)\\b(?:(?:m(?:s(?:ys(?:ac(?:cess(?:objects|storage|xml)|es)|(?:relationship|object|querie)s|modules2?)|db)|aster\\.\\.sysdatabases|ysql\\.db)|pg_(?:catalog|toast)|information_schema|northwind|tempdb)\\b|s(?:(?:ys(?:\\.database_name|aux)|qlite(?:_temp)?_master)\\b|chema(?:_name\\b|\\W*\\())|d(?:atabas|b_nam)e\\W*\\()","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942151","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack","operator":"REGEX","opts":{"transform":["uri_decode_uni","lowercase"]},"pattern":"(?i)\\b(?:c(?:o(?:n(?:v(?:ert(?:_tz)?)?|cat(?:_ws)?|nection_id)|(?:mpres)?s|ercibility|llation|alesce|t)|ur(?:rent_(?:time(?:stamp)?|date|user)|(?:dat|tim)e)|ha(?:racte)?r_length|iel(?:ing)?|r32)|s(?:t(?:d(?:dev_(?:sam|po)p)?|r(?:_to_date|cmp))|ub(?:str(?:ing(?:_index)?)?|(?:dat|tim)e)|e(?:ssion_user|c_to_time)|ys(?:tem_user|date)|ha[12]?|oundex|chema|pace|qrt|in)|i(?:s(?:_(?:ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|(?:free|used)_lock)|null)|n(?:et(?:6_(?:aton|ntoa)|_(?:aton|ntoa))|s(?:ert|tr)|terval)|fnull)|d(?:a(?:t(?:e(?:_(?:format|add|sub)|diff)|abase)|y(?:of(?:month|week|year)|name))|e(?:s_(?:de|en)crypt|grees|code)|count|ump)|l(?:o(?:ca(?:ltimestamp|te)|g(?:10|2)|ad_file|wer)|ast_(?:inser_id|day)|e(?:as|f)t|inestring|case|trim|pad)|t(?:ime(?:_(?:format|to_sec)|stamp(?:diff|add)?|diff)|o(?:(?:second|day)s|_base64|n?char)|r(?:uncate|im))|u(?:n(?:compress(?:ed_length)?|ix_timestamp|hex)|tc_(?:time(?:stamp)?|date)|uid(?:_short)?|pdatexml|case)|m(?:a(?:ke(?:_set|date)|ster_pos_wait)|ulti(?:po(?:lygon|int)|linestring)|i(?:crosecon)?d|onthname|d5)|g(?:e(?:t_(?:format|lock)|ometrycollection)|(?:r(?:oup_conca|eates)|tid_subse)t)|p(?:o(?:(?:siti|lyg)on|w)|eriod_(?:diff|add)|rocedure_analyse|g_sleep)|a(?:s(?:cii(?:str)?|in)|es_(?:de|en)crypt|dd(?:dat|tim)e|tan2?)|f(?:rom_(?:unixtime|base64|days)|i(?:el|n)d_in_set|ound_rows)|e(?:x(?:tract(?:value)?|p(?:ort_set)?)|nc(?:rypt|ode)|lt)|b(?:i(?:t_(?:length|count|x?or|and)|n_to_num)|enchmark)|r(?:a(?:wtohex|dians|nd)|elease_lock|ow_count|trim|pad)|o(?:(?:ld_passwo)?rd|ct(?:et_length)?)|we(?:ek(?:ofyear|day)|ight_string)|n(?:ame_const|ot_in|ullif)|var(?:_(?:sam|po)p|iance)|qu(?:arter|ote)|hex(?:toraw)?|yearweek|xmltype)\\W*\\(","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942160","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects blind sqli tests using sleep() or benchmark()","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i:sleep\\(\\s*?\\d*?\\s*?\\)|benchmark\\(.*?\\,.*?\\))","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66"],"vars":[{"type":"REQUEST_BASENAME"},{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942170","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects SQL benchmark and sleep injection attempts including conditional queries","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:select|;)\\s+(?:benchmark|sleep|if)\\s*?\\(\\s*?\\(?\\s*?\\w+","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942190","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects MSSQL code execution and information gathering attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni","remove_comments_char"]},"pattern":"(?i)(?:\\b(?:u(?:nion(?:[\\w(\\s]*?select|\\sselect\\s@)|ser\\s*?\\([^\\)]*?)|(?:c(?:onnection_id|urrent_user)|database)\\s*?\\([^\\)]*?|s(?:chema\\s*?\\([^\\)]*?|elect.*?\\w?user\\()|into[\\s+]+(?:dump|out)file\\s*?[\"'`]|from\\W+information_schema\\W|exec(?:ute)?\\s+master\\.)|[\"'`](?:;?\\s*?(?:union\\b\\s*?(?:(?:distin|sele)ct|all)|having|select)\\b\\s*?[^\\s]|\\s*?!\\s*?[\"'`\\w])|\\s*?exec(?:ute)?.*?\\Wxp_cmdshell|\\Wiif\\s*?\\()","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942220","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Looking for integer overflow attacks, these are taken from skipfish, except 2.2.2250738585072011e-308 is the \"magic number\" crash","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"^(?i:-0000023456|4294967295|4294967296|2147483648|2147483647|0000012345|-2147483648|-2147483649|0000023456|2.2250738585072007e-308|2.2250738585072011e-308|1e309)$","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942230","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects conditional SQL injection attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:select.*?having\\s*?[^\\s]+\\s*?[^\\w\\s]|[\\s()]case\\s+when.*?then|if\\s?\\(\\w+\\s*?[=<>~]|\\)\\s*?like\\s*?\\()","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942240","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects MySQL charset switch and MSSQL DoS attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:[\"'`](?:;*?\\s*?waitfor\\s+(?:delay|time)\\s+[\"'`]|;.*?:\\s*?goto)|alter\\s*?\\w+.*?cha(?:racte)?r\\s+set\\s+\\w+)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942250","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects MATCH AGAINST, MERGE and EXECUTE IMMEDIATE injections","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i:merge.*?using\\s*?\\(|execute\\s*?immediate\\s*?[\"'`]|match\\s*?[\\w(),+-]+\\s*?against\\s*?\\()","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942270","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Looking for basic sql injection. Common attack string for mysql, oracle and others","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)union.*?select.*?from","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942280","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects Postgres pg_sleep injection, waitfor delay attacks and database shutdown attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:;\\s*?shutdown\\s*?(?:[#;{]|\\/\\*|--)|waitfor\\s*?delay\\s?[\"'`]+\\s?\\d|select\\s*?pg_sleep)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942290","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Finds basic MongoDB SQL injection attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i:(?:\\[\\$(?:ne|eq|lte?|gte?|n?in|mod|all|size|exists|type|slice|x?or|div|like|between|and)\\]))","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942320","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects MySQL and PostgreSQL stored procedure/function injections","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:create\\s+(?:procedure|function)\\s*?\\w+\\s*?\\(\\s*?\\)\\s*?-|;\\s*?(?:declare|open)\\s+[\\w-]+|procedure\\s+analyse\\s*?\\(|declare[^\\w]+[@#]\\s*?\\w+|exec\\s*?\\(\\s*?@)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942350","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects MySQL UDF injection and other data/structure manipulation attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:;\\s*?(?:(?:(?:trunc|cre|upd)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|alter|load)\\b\\s*?[\\[(]?\\w{2,}|create\\s+function\\s.+\\sreturns)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942360","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects concatenated basic SQL injection and SQLLFI attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:^[\\W\\d]+\\s*?(?:alter\\s*(?:a(?:(?:pplication\\s*rol|ggregat)e|s(?:ymmetric\\s*ke|sembl)y|u(?:thorization|dit)|vailability\\s*group)|c(?:r(?:yptographic\\s*provider|edential)|o(?:l(?:latio|um)|nversio)n|ertificate|luster)|s(?:e(?:rv(?:ice|er)|curity|quence|ssion|arch)|y(?:mmetric\\s*key|nonym)|togroup|chema)|m(?:a(?:s(?:ter\\s*key|k)|terialized)|e(?:ssage\\s*type|thod)|odule)|l(?:o(?:g(?:file\\s*group|in)|ckdown)|a(?:ngua|r)ge|ibrary)|t(?:(?:abl(?:espac)?|yp)e|r(?:igger|usted)|hreshold|ext)|p(?:a(?:rtition|ckage)|ro(?:cedur|fil)e|ermission)|d(?:i(?:mension|skgroup)|atabase|efault|omain)|r(?:o(?:l(?:lback|e)|ute)|e(?:sourc|mot)e)|f(?:u(?:lltext|nction)|lashback|oreign)|e(?:xte(?:nsion|rnal)|(?:ndpoi|ve)nt)|in(?:dex(?:type)?|memory|stance)|b(?:roker\\s*priority|ufferpool)|x(?:ml\\s*schema|srobject)|w(?:ork(?:load)?|rapper)|hi(?:erarchy|stogram)|o(?:perator|utline)|(?:nicknam|queu)e|us(?:age|er)|group|java|view)\\b|(?:(?:(?:trunc|cre)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load)\\s+\\w+|u(?:nion\\s*(?:(?:distin|sele)ct|all)\\b|pdate\\s+\\w+))|\\b(?:(?:(?:(?:trunc|cre|upd)at|renam)e|(?:inser|selec)t|de(?:lete|sc)|alter|load)\\s+(?:group_concat|load_file|char)\\b\\s*\\(?|end\\s*?\\);)|[\"'`\\w]\\s+as\\b\\s*[\"'`\\w]+\\s*\\bfrom|[\\s(]load_file\\s*?\\(|[\"'`]\\s+regexp\\W)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942500","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"MySQL in-line comment detected","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i:/\\*[!+](?:[\\w\\s=_\\-()]+)?\\*/)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"RCE_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"944130","logdata":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}","msg":"Suspicious Java class detected","operator":"PM","pattern":["com.opensymphony.xwork2","com.sun.org.apache","java.io.BufferedInputStream","java.io.BufferedReader","java.io.ByteArrayInputStream","java.io.ByteArrayOutputStream","java.io.CharArrayReader","java.io.DataInputStream","java.io.File","java.io.FileOutputStream","java.io.FilePermission","java.io.FileWriter","java.io.FilterInputStream","java.io.FilterOutputStream","java.io.FilterReader","java.io.InputStream","java.io.InputStreamReader","java.io.LineNumberReader","java.io.ObjectOutputStream","java.io.OutputStream","java.io.PipedOutputStream","java.io.PipedReader","java.io.PrintStream","java.io.PushbackInputStream","java.io.Reader","java.io.StringReader","java.lang.Class","java.lang.Integer","java.lang.Number","java.lang.Object","java.lang.Process","java.lang.ProcessBuilder","java.lang.reflect","java.lang.Runtime","java.lang.String","java.lang.StringBuilder","java.lang.System","javax.script.ScriptEngineManager","org.apache.commons","org.apache.struts","org.apache.struts2","org.omg.CORBA","java.beans.XMLDecode"],"severity":"CRITICAL","tag":["application-multi","language-java","platform-multi","OWASP_CRS","capec/1000/152/248","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"type":"REQUEST_BODY"},{"type":"URI"},{"parse":["values","1"],"type":"REQUEST_HEADERS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"RCE_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"944140","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Java Injection Attack: Java Script File Upload Found","operator":"REGEX","opts":{"transform":["lowercase"]},"pattern":".*\\.(?:jsp|jspx)\\.*$","severity":"CRITICAL","tag":["application-multi","language-java","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"type":"FILES"},{"parse":["specific","X-Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X_Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X.Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X-File-Name"],"type":"REQUEST_HEADERS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.WARNING_ANOMALY_SCORE}"}}]},"id":"942110","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack: Common Injection Testing Detected","operator":"REGEX","opts":{"transform":["utf8_to_unicode","uri_decode_uni"]},"pattern":"(?:^\\s*[\"'`;]+|[\"'`]+\\s*$)","severity":"WARNING","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942120","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack: SQL Operator Detected","operator":"REGEX","opts":{"transform":["utf8_to_unicode","uri_decode_uni"]},"pattern":"(?i)(?:not\\s+between\\s+(?:(?:(?:'[^']*')|(?:\"[^\"]*\"))\\s+and\\s+(?:(?:'[^']*')|(?:\"[^\"]*\"))|0\\s+and)|(?:^|\\W)in[+\\s]*\\([\\s\\d\"]+[^()]*\\)|\\b(?:r(?:egexp|like)|isnull|xor)\\b|<(?:>(?:\\s+binary)?|=>?|<)|r(?:egexp|like)\\s+binary|(?:like|is)\\s+null|>[=>]|\\|\\||!=|&&)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942130","logdata":"Matched Data: %{TX.0} found within %{TX.942130_MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack: SQL Boolean-based attack detected","operator":"EQUALS","opts":{"parsepattern":1},"pattern":"%{TX.2}","vars":[{"parse":["specific","942130_LHS"],"storage":1,"type":"TX"}],"attack_tag":"attack-sqli"},{"actions":{"disrupt":"CHAIN","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"942130_LHS","value":"%{TX.1}"}},{"action":"setvar","data":{"col":"TX","key":"942130_MATCHED_VAR_NAME","value":"%{MATCHED_VAR_NAME}"}}]},"id":"942130","operator":"REGEX","opts":{"transform":["uri_decode_uni","replace_comments"]},"pattern":"(?i)[\\s'\"`()]*?\\b([\\d\\w]+)\\b[\\s'\"`()]*?(?:(?:sounds\\s+)?like|r(?:egexp|like)|<=>|=)[\\s'\"`()]*?\\b([\\d\\w]+)\\b","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942131","logdata":"Matched Data: %{TX.0} found within %{TX.942131_MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack: SQL Boolean-based attack detected","op_negated":1,"operator":"EQUALS","opts":{"parsepattern":1},"pattern":"%{TX.2}","vars":[{"parse":["specific","942131_LHS"],"storage":1,"type":"TX"}],"attack_tag":"attack-sqli"},{"actions":{"disrupt":"CHAIN","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"942131_LHS","value":"%{TX.1}"}},{"action":"setvar","data":{"col":"TX","key":"942131_MATCHED_VAR_NAME","value":"%{MATCHED_VAR_NAME}"}}]},"id":"942131","operator":"REGEX","opts":{"transform":["uri_decode_uni","replace_comments"]},"pattern":"(?i)[\\s'\"`()]*?\\b([\\d\\w]+)\\b[\\s'\"`()]*?(?:not\\s+(?:r(?:egexp|like)|like)|is\\s+not|![<=>]|<[=>]?|>=?|\\^)[\\s'\"`()]*?\\b([\\d\\w]+)\\b","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942150","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack","operator":"REGEX","opts":{"transform":["uri_decode_uni","lowercase"]},"pattern":"(?i)\\b(?:r(?:e(?:p(?:lace|eat)|verse)|ight|ound)|c(?:h(?:ar(?:set)?|r)|(?:oun|as)t)|m(?:in(?:ute)?|o(?:nth|d)|ax)|l(?:o(?:cal|g)|ength|ast|n)|(?:u(?:pp|s)e|hou|yea)r|s(?:econd|leep|ign|um)|d(?:a(?:te|y)|efault)|f(?:ormat|ield|loor)|p(?:assword|ower|i)|a(?:(?:co|b)s|vg)|v(?:ersion|alues)|t(?:ime|an)|i[fn]|week|bin|now)\\W*\\(","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942180","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects basic SQL authentication bypass attempts 1/3","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:[\"'`](?:\\s*?(?:(?:between|x?or|and|div)[\\w\\s-]+\\s*?[+<>=(),-]\\s*?[\\d\"'`]|like(?:[\\w\\s-]+\\s*?[+<>=(),-]\\s*?[\\d\"'`]|\\W+[\\w\"'`(])|[!=|](?:[\\d\\s!=+-]+.*?[\"'`(].*?|[\\d\\s!=]+.*?\\d+)$|[^\\w\\s]?=\\s*?[\"'`])|(?:\\W*?[+=]+\\W*?|[<>~]+)[\"'`])|(?:/\\*)+[\"'`]+\\s?(?:[#{]|\\/\\*|--)?|\\d[\"'`]\\s+[\"'`]\\s+\\d|where\\s[\\s\\w\\.,-]+\\s=|^admin\\s*?[\"'`]|\\sis\\s*?0\\W)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942200","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects MySQL comment-/space-obfuscated injections and backtick termination","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:(?:(?:(?:trunc|cre|upd)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|alter|load)\\s*?\\(\\s*?space\\s*?\\(|,.*?[)\\da-f\"'`][\"'`](?:[\"'`].*?[\"'`]|(?:\\r?\\n)?\\z|[^\"'`]+)|\\Wselect.+\\W*?from)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942210","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects chained SQL injection attempts 1/2","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:(?:n(?:and|ot)|(?:x?x)?or|between|\\|\\||like|and|div|&&)[\\s(]+\\w+[\\s)]*?[!=+]+[\\s\\d]*?[\"'`=()]|\\d(?:\\s*?(?:between|like|x?or|and|div)\\s*?\\d+\\s*?[\\-+]|\\s+group\\s+by.+\\()|\\/\\w+;?\\s+(?:between|having|select|like|x?or|and|div)\\W|--\\s*?(?:(?:insert|update)\\s*?\\w{2,}|alter|drop)|#\\s*?(?:(?:insert|update)\\s*?\\w{2,}|alter|drop)|;\\s*?(?:(?:insert|update)\\s*?\\w{2,}|alter|drop)|@.+=\\s*?\\(\\s*?select|[^\\w]SET\\s*?@\\w+)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942260","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects basic SQL authentication bypass attempts 2/3","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:[\"'`]\\s*?(?:(?:n(?:and|ot)|(?:x?x)?or|between|\\|\\||and|div|&&)\\s+[\\s\\w]+=\\s*?\\w+\\s*?having\\s+|like(?:\\s+[\\s\\w]+=\\s*?\\w+\\s*?having\\s+|\\W*?[\"'`\\d]))|select\\s+?[\\[\\]()\\s\\w\\.,\"'`-]+from\\s+|\\w\\s+like\\s+[\"'`]|like\\s*?[\"'`]%)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942300","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects MySQL comments, conditions and ch(a)r injections","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:\\b(?:(?:r(?:egexp|like)|n(?:and|ot)|(?:x?x)?or|like|and|div)\\s+\\s*?\\w+\\(|b(?:etween\\s+\\s*?\\w+\\(|inary\\s*?\\(\\s*?\\d)|cha?r\\s*?\\(\\s*?\\d)|\\)\\s*?when\\s*?\\d+\\s*?then|(?:\\|\\||&&)\\s+\\s*?\\w+\\(|[\"'`]\\s*?(?:[#{]|--)|\\/\\*!\\s?\\d+)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942310","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects chained SQL injection attempts 2/2","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:(?:\\(\\s*?select\\s*?\\w+|order\\s+by\\s+if\\w*?|coalesce)\\s*?\\(|[\"'`](?:;\\s*?(?:begin|while|if)|[\\s\\d]+=\\s*?\\d)|\\w[\"'`]\\s*?(?:(?:[-+=|@]+\\s+?)+|[-+=|@]+)[\\d(]|[\\s(]+case\\d*?\\W.+[tw]hen[\\s(]|\\+\\s*?\\d+\\s*?\\+\\s*?@|@@\\w+\\s*?[^\\w\\s]|\\W!+[\"'`]\\w|\\*\\/from)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942330","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects classic SQL injection probings 1/3","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:^(?:[\"'`\\x5c]*?(?:[^\"'`]+[\"'`]|[\\d\"'`]+)\\s*?(?:n(?:and|ot)|(?:x?x)?or|between|\\|\\||like|and|div|&&)\\s*?[\\w\"'`][+&!@(),.-]|.?[\"'`]$)|@(?:[\\w-]+\\s(?:between|like|x?or|and|div)\\s*?[^\\w\\s]|\\w+\\s+(?:between|like|x?or|and|div)\\s*?[\"'`\\d]+)|[\"'`]\\s*?(?:between|like|x?or|and|div)\\s*?[\"'`]?\\d|[^\\w\\s:]\\s*?\\d\\W+[^\\w\\s]\\s*?[\"'`].|[^\\w\\s]\\w+\\s*?[|-]\\s*?[\"'`]\\s*?\\w|\\Winformation_schema|\\x5cx(?:23|27|3d)|table_name\\W)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942340","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects basic SQL authentication bypass attempts 3/3","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:[\"'`](?:\\s*?(?:is\\s*?(?:[\\d.]+\\s*?\\W.*?[\"'`]|\\d.+[\"'`]?\\w)|\\d\\s*?(?:--|#))|(?:\\W+[\\w+-]+\\s*?=\\s*?\\d\\W+|\\|?[\\w-]{3,}[^\\w\\s.,]+)[\"'`]|[\\%&<>^=]+\\d\\s*?(?:between|like|x?or|and|div|=))|(?i:n?and|x?x?or|div|like|between|not|\\|\\||\\&\\&)\\s+[\\s\\w+]+(?:sounds\\s+like\\s*?[\"'`]|regexp\\s*?\\(|[=\\d]+x)|in\\s*?\\(+\\s*?select)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942361","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects basic SQL injection based on keyword alter or union","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i:^[\\W\\d]+\\s*?(?:alter|union)\\b)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942362","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects concatenated basic SQL injection and SQLLFI attempts","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:^[\\W\\d]+\\s*?(?:(?:alter\\s*(?:a(?:(?:pplication\\s*rol|ggregat)e|s(?:ymmetric\\s*ke|sembl)y|u(?:thorization|dit)|vailability\\s*group)|c(?:r(?:yptographic\\s*provider|edential)|o(?:l(?:latio|um)|nversio)n|ertificate|luster)|s(?:e(?:rv(?:ice|er)|curity|quence|ssion|arch)|y(?:mmetric\\s*key|nonym)|togroup|chema)|m(?:a(?:s(?:ter\\s*key|k)|terialized)|e(?:ssage\\s*type|thod)|odule)|l(?:o(?:g(?:file\\s*group|in)|ckdown)|a(?:ngua|r)ge|ibrary)|t(?:(?:abl(?:espac)?|yp)e|r(?:igger|usted)|hreshold|ext)|p(?:a(?:rtition|ckage)|ro(?:cedur|fil)e|ermission)|d(?:i(?:mension|skgroup)|atabase|efault|omain)|r(?:o(?:l(?:lback|e)|ute)|e(?:sourc|mot)e)|f(?:u(?:lltext|nction)|lashback|oreign)|e(?:xte(?:nsion|rnal)|(?:ndpoi|ve)nt)|in(?:dex(?:type)?|memory|stance)|b(?:roker\\s*priority|ufferpool)|x(?:ml\\s*schema|srobject)|w(?:ork(?:load)?|rapper)|hi(?:erarchy|stogram)|o(?:perator|utline)|(?:nicknam|queu)e|us(?:age|er)|group|java|view)|u(?:nion\\s*(?:(?:distin|sele)ct|all)|pdate)|d(?:e(?:lete|sc)|rop)|(?:truncat|renam)e|(?:inser|selec)t|load)\\b|create\\s+\\w+)|(?:(?:(?:trunc|cre|upd)at|renam)e|(?:inser|selec)t|de(?:lete|sc)|alter|load)\\s+(?:group_concat|load_file|char)\\s?\\(?|[\\d\\W]\\s+as\\b\\s*[\"'`\\w]+\\s*\\bfrom|[\\s(]load_file\\s*?\\(|[\"'`]\\s+regexp\\W|end\\s*?\\);)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942370","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects classic SQL injection probings 2/3","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:[\"'`](?:\\s*?(?:(?:\\*.+(?:(?:an|i)d|between|like|x?or|div)\\W*?[\"'`]|(?:between|like|x?or|and|div)\\s[^\\d]+[\\w-]+.*?)\\d|[^\\w\\s?]+\\s*?[^\\w\\s]+\\s*?[\"'`]|[^\\w\\s]+\\s*?[\\W\\d].*?(?:--|#))|.*?\\*\\s*?\\d)|[()\\*<>%+-][\\w-]+[^\\w\\s]+[\"'`][^,]|\\^[\"'`])","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942380","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:\\b(?:having\\b(?: ?(?:[\\'\"][^=]{1,10}[\\'\" ?[=<>]+|\\d{1,10} ?[=<>]+)|\\s+(?:'[^=]{1,10}'|\\d{1,10})\\s*?[=<>])|ex(?:ecute(?:\\s{1,5}[\\w\\.$]{1,5}\\s{0,3}|\\()|ists\\s*?\\(\\s*?select\\b)|(?:create\\s+?table.{0,20}?|like\\W*?char\\W*?)\\()|exists\\s(?:s(?:elect\\S(?:if(?:null)?\\s\\(|concat|top)|ystem\\s\\()|\\bhaving\\b\\s+\\d{1,10}|'[^=]{1,10}'|\\sselect)|select.*?case|from.*?limit|order\\sby)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942390","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:\\b(?:or\\b(?:\\s+(?:'[^=]{1,10}'(?:\\s*?[=<>])?|\\d{1,10}(?:\\s*?[=<>])?)|\\s?(?:[\\'\"][^=]{1,10}[\\'\"]|\\d{1,10})\\s?[=<>]+)|xor\\b\\s+(?:'[^=]{1,10}'(?:\\s*?[=<>])?|\\d{1,10}(?:\\s*?[=<>])?))|'\\s+x?or\\s+.{1,20}[+\\-!<>=])","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942400","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)\\band\\b(?: ?(?:[\\'\"][^=]{1,10}[\\'\"]|\\d{1,10}) ?[=<>]+|\\s+(?:\\d{1,10}\\s*?[=<>]|'[^=]{1,10}'))","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942410","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)\\b(?:c(?:o(?:n(?:v(?:ert(?:_tz)?)?|cat(?:_ws)?|nection_id)|(?:mpres)?s|ercibility|(?:un)?t|alesce)|ur(?:rent_(?:time(?:stamp)?|date|user)|(?:dat|tim)e)|h(?:ar(?:(?:acter)?_length|set)?|r)|iel(?:ing)?|ast|r32)|s(?:t(?:d(?:dev(?:_(?:sam|po)p)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(?:_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha[12]?|oundex|chema|ig?n|leep|pace|qrt)|i(?:s(?:_(?:ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|(?:free|used)_lock)|null)?|n(?:et(?:6_(?:aton|ntoa)|_(?:aton|ntoa))|s(?:ert|tr)|terval)?|f(?:null)?)|d(?:a(?:t(?:e(?:_(?:format|add|sub)|diff)?|abase)|y(?:of(?:month|week|year)|name)?)|e(?:(?:s_(?:de|en)cryp|faul)t|grees|code)|count|ump)|l(?:o(?:ca(?:l(?:timestamp)?|te)|g(?:10|2)?|ad_file|wer)|ast(?:_(?:insert_id|day))?|e(?:(?:as|f)t|ngth)|case|trim|pad|n)|u(?:n(?:compress(?:ed_length)?|ix_timestamp|hex)|tc_(?:time(?:stamp)?|date)|p(?:datexml|per)|uid(?:_short)?|case|ser)|r(?:a(?:wto(?:nhex(?:toraw)?|hex)|dians|nd)|e(?:p(?:lace|eat)|lease_lock|verse)|o(?:w_count|und)|ight|trim|pad)|t(?:ime(?:_(?:format|to_sec)|stamp(?:diff|add)?|diff)?|o_(?:(?:second|day)s|base64|n?char)|r(?:uncate|im)|an)|m(?:a(?:ke(?:_set|date)|ster_pos_wait|x)|i(?:(?:crosecon)?d|n(?:ute)?)|o(?:nth(?:name)?|d)|d5)|f(?:i(?:eld(?:_in_set)?|nd_in_set)|rom_(?:unixtime|base64|days)|o(?:und_rows|rmat)|loor)|p(?:o(?:w(?:er)?|sition)|eriod_(?:diff|add)|rocedure_analyse|assword|g_sleep|i)|a(?:s(?:cii(?:str)?|in)|es_(?:de|en)crypt|dd(?:dat|tim)e|(?:co|b)s|tan2?|vg)|b(?:i(?:t_(?:length|count|x?or|and)|n(?:_to_num)?)|enchmark)|e(?:x(?:tract(?:value)?|p(?:ort_set)?)|nc(?:rypt|ode)|lt)|g(?:r(?:oup_conca|eates)t|et_(?:format|lock))|v(?:a(?:r(?:_(?:sam|po)p|iance)|lues)|ersion)|o(?:(?:ld_passwo)?rd|ct(?:et_length)?)|we(?:ek(?:ofyear|day)?|ight_string)|n(?:o(?:t_in|w)|ame_const|ullif)|h(?:ex(?:toraw)?|our)|qu(?:arter|ote)|year(?:week)?|xmltype)\\W*?\\(","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942470","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:xp_(?:reg(?:re(?:movemultistring|ad)|delete(?:value|key)|enum(?:value|key)s|addmultistring|write)|(?:servicecontro|cmdshel)l|e(?:xecresultset|numdsn)|ntsec(?:_enumdomains)?|terminate(?:_process)?|availablemedia|loginconfig|filelist|dirtree|makecab)|s(?:p_(?:(?:addextendedpro|sqlexe)c|p(?:assword|repare)|replwritetovarbin|is_srvrolemember|execute(?:sql)?|makewebtask|oacreate|help)|ql_(?:longvarchar|variant))|open(?:owa_util|rowset|query)|(?:n?varcha|tbcreato)r|autonomous_transaction|db(?:a_users|ms_java)|utl_(?:file|http))","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942480","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)(?:\\b(?:(?:s(?:elect\\b.{1,100}?\\b(?:(?:(?:length|count)\\b.{1,100}?|.*?\\bdump\\b.*)\\bfrom|to(?:p\\b.{1,100}?\\bfrom|_(?:numbe|cha)r)|(?:from\\b.{1,100}?\\bwher|data_typ)e|instr)|ys_context)|in(?:to\\b\\W*?\\b(?:dump|out)file|sert\\b\\W*?\\binto|ner\\b\\W*?\\bjoin)|u(?:nion\\b.{1,100}?\\bselect|tl_inaddr)|group\\b.*?\\bby\\b.{1,100}?\\bhaving|d(?:elete\\b\\W*?\\bfrom|bms_\\w+\\.)|load\\b\\W*?\\bdata\\b.*?\\binfile)\\b|print\\b\\W*?\\@\\@)|(?:;\\W*?\\b(?:shutdown|drop)|collation\\W*?\\(a|\\@\\@version)\\b|'(?:s(?:qloledb|a)|msdasql|dbo)')","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}}]},"id":"942430","logdata":"Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\"'`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\"'`<>]*?){12})","severity":"WARNING","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942440","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Comment Sequence Detected","op_negated":1,"operator":"REFIND","pattern":"^ey[A-Z-a-z0-9-_]+[.]ey[A-Z-a-z0-9-_]+[.][A-Z-a-z0-9-_]+$","vars":[{"type":"MATCHED_VARS"}],"attack_tag":"attack-sqli"},{"actions":{"disrupt":"CHAIN"},"id":"942440","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?:--(?:[^-]*?-|\\s)|[^&-]#.*?\\s|;?\\x00|[';]--|\\/\\*!?|\\*\\/)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942450","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Hex Encoding Identified","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i:\\b0x[a-f\\d]{3,})","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942510","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQLi bypass attempt by ticks or backticks detected","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?:`(?:(?:[\\w\\s=_\\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)`)","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"RCE_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE_PL2","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"944260","logdata":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}","msg":"Remote Command Execution: Malicious class-loading payload","operator":"REFIND","opts":{"transform":["uri_decode_uni"]},"pattern":"(?:class\\.module\\.classLoader\\.resources\\.context\\.parent\\.pipeline|springframework\\.context\\.support\\.FileSystemXmlApplicationContext)","severity":"CRITICAL","tag":["application-multi","language-java","platform-multi","OWASP_CRS","capec/1000/152/248","PCI/6.5.2"],"vars":[{"parse":["values","1"],"type":"REQUEST_ARGS"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"type":"REQUEST_BODY"},{"parse":["values","1"],"type":"REQUEST_HEADERS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":2},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL3","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933131","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: Variables Found","operator":"REGEX","opts":{"transform":["normalise_path","uri_decode_uni"]},"pattern":"(?:HTTP_(?:ACCEPT(?:_(?:ENCODING|LANGUAGE|CHARSET))?|(?:X_FORWARDED_FO|REFERE)R|(?:USER_AGEN|HOS)T|CONNECTION|KEEP_ALIVE)|PATH_(?:TRANSLATED|INFO)|ORIG_PATH_INFO|QUERY_STRING|REQUEST_URI|AUTH_TYPE)","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":3},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL3","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933161","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: Low-Value PHP Function Call Found","operator":"REGEX","pattern":"(?i)\\b(?:i(?:s(?:_(?:in(?:t(?:eger)?|finite)|n(?:u(?:meric|ll)|an)|(?:calla|dou)ble|s(?:calar|tring)|f(?:inite|loat)|re(?:source|al)|l(?:ink|ong)|a(?:rray)?|object|bool)|set)|n(?:(?:clud|vok)e|t(?:div|val))|(?:mplod|dat)e|conv)|s(?:t(?:r(?:(?:le|sp)n|coll)|at)|(?:e(?:rializ|ttyp)|huffl)e|i(?:milar_text|zeof|nh?)|p(?:liti?|rintf)|(?:candi|ubst)r|y(?:mlink|slog)|o(?:undex|rt)|leep|rand|qrt)|f(?:ile(?:(?:siz|typ)e|owner|pro)|l(?:o(?:atval|ck|or)|ush)|(?:rea|mo)d|t(?:ell|ok)|unction|close|gets|stat|eof)|c(?:h(?:o(?:wn|p)|eckdate|root|dir|mod)|o(?:(?:(?:nsta|u)n|mpac)t|sh?|py)|lose(?:dir|log)|(?:urren|ryp)t|eil)|e(?:x(?:(?:trac|i)t|p(?:lode)?)|a(?:ster_da(?:te|ys)|ch)|r(?:ror_log|egi?)|mpty|cho|nd)|l(?:o(?:g(?:1[0p])?|caltime)|i(?:nk(?:info)?|st)|(?:cfirs|sta)t|evenshtein|trim)|d(?:i(?:(?:skfreespac)?e|r(?:name)?)|e(?:fined?|coct)|(?:oubleva)?l|ate)|r(?:e(?:(?:quir|cod|nam)e|adlin[ek]|wind|set)|an(?:ge|d)|ound|sort|trim)|m(?:b(?:split|ereg)|i(?:crotime|n)|a(?:i[ln]|x)|etaphone|y?sql|hash)|u(?:n(?:(?:tain|se)t|iqid|link)|s(?:leep|ort)|cfirst|mask)|a(?:s(?:(?:se|o)rt|inh?)|r(?:sort|ray)|tan[2h]?|cosh?|bs)|t(?:e(?:xtdomain|mpnam)|a(?:int|nh?)|ouch|ime|rim)|h(?:e(?:ader(?:s_(?:lis|sen)t)?|brev)|ypot|ash)|p(?:a(?:thinfo|ck)|r(?:intf?|ev)|close|o[sw]|i)|g(?:et(?:t(?:ext|ype)|date)|mdate)|o(?:penlog|ctdec|rd)|b(?:asename|indec)|n(?:atsor|ex)t|k(?:sort|ey)|quotemeta|wordwrap|virtual|join)(?:\\s|/\\*.*\\*/|//.*|#.*)*\\(.*\\)","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"type":"URI"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":3},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL3","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933111","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: PHP Script File Upload Found","operator":"REGEX","opts":{"transform":["lowercase"]},"pattern":".*\\.(?:php\\d*|phtml)\\..*$","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"type":"FILES"},{"parse":["specific","X-Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X_Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X.Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X-File-Name"],"type":"REQUEST_HEADERS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":3},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL3","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933190","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: PHP Closing Tag Found","operator":"PM","opts":{"transform":["uri_decode_uni"]},"pattern":["?>"],"severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":3},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL3","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942251","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects HAVING injections","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?i)\\W+\\d*?\\s*?\\bhaving\\b\\s*?[^\\s\\-]","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":3},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL3","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942490","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Detects classic SQL injection probings 3/3","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"[\"'`][\\s\\d]*?[^\\w\\s]\\W*?\\d\\W*?.*?[\"'`\\d]","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":3},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL3","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}}]},"id":"942420","logdata":"Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (8)","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\"'`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\"'`<>]*?){8})","severity":"WARNING","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":3},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL3","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}}]},"id":"942431","logdata":"Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\"'`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\"'`<>]*?){6})","severity":"WARNING","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":3},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL3","value":"%{TX.WARNING_ANOMALY_SCORE}"}}]},"id":"942460","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"\\W{4}","severity":"WARNING","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":3},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL3","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942101","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack Detected via libinjection","operator":"DETECT_SQLI","opts":{"transform":["utf8_to_unicode","uri_decode_uni","remove_nulls"]},"pattern":"","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"type":"REQUEST_BASENAME"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":3},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL3","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"942511","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQLi bypass attempt by ticks detected","operator":"REGEX","opts":{"transform":["uri_decode_uni"]},"pattern":"(?:'(?:(?:[\\w\\s=_\\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)')","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","OWASP_CRS","capec/1000/152/248/66","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-sqli","paranoia_level":3}]}