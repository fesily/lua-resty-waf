{"access":[{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933100","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: PHP Open Tag Found","operator":"REGEX","opts":{"transform":["lowercase"]},"pattern":"(?:<\\?(?:[^x]|x[^m]|xm[^l]|xml[^\\s]|xml$|$)|<\\?php|\\[(?:/|\\x5c)?php\\])","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933110","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: PHP Script File Upload Found","operator":"REGEX","opts":{"transform":["lowercase"]},"pattern":".*\\.(?:php\\d*|phtml)\\.*$","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"type":"FILES"},{"parse":["specific","X-Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X_Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X.Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X-File-Name"],"type":"REQUEST_HEADERS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933120","logdata":"Matched Data: %{TX.933120_TX_0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: Configuration Directive Found","operator":"PM","pattern":["="],"vars":[{"type":"MATCHED_VARS"}],"attack_tag":"attack-virtualpatch"},{"actions":{"disrupt":"CHAIN","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"933120_TX_0","value":"%{TX.0}"}}]},"id":"933120","operator":"PM","opts":{"transform":["normalise_path"]},"pattern":["allow_call_time_pass_reference","allow_url_fopen","allow_url_include","always_populate_raw_post_data","arg_separator.input","arg_separator.output","asp_tags","assert.active","assert.bail","assert.callback","assert.quiet_eval","assert.warning","auto_append_file","auto_detect_line_endings","auto_globals_jit","auto_prepend_file","bcmath.scale","birdstep.max_links","browscap","cgi.fix_pathinfo","cgi.force_redirect","cgi.nph","cgi.redirect_status_env","cgi.rfc2616_headers","com.allow_dcom","com.autoregister_casesensitive","com.autoregister_typelib","com.autoregister_verbose","com.code_page","com.typelib_file","date.default_latitude","date.default_longitude","date.sunrise_zenith","date.sunset_zenith","date.timezone","dba.default_handler","default_charset","default_mimetype","default_socket_timeout","define_syslog_variables","disable_classes","disable_functions","display_errors","display_startup_errors","doc_root","docref_ext","docref_root","enable_dl","error_append_string","error_log","error_prepend_string","error_reporting","exif.decode_jis_intel","exif.decode_jis_motorola","exif.decode_unicode_intel","exif.decode_unicode_motorola","exif.encode_jis","exif.encode_unicode","expose_php","extension_dir","fastcgi.impersonate","fastcgi.logging","file_uploads","filter.default","filter.default_flags","gd.jpeg_ignore_warning","highlight.bg","highlight.comment","highlight.default","highlight.html","highlight.keyword","highlight.string","html_errors","ibase.allow_persistent","ibase.dateformat","ibase.default_charset","ibase.default_db","ibase.default_password","ibase.default_user","ibase.max_links","ibase.max_persistent","ibase.timeformat","ibase.timestampformat","iconv.input_encoding","iconv.internal_encoding","iconv.output_encoding","ignore_repeated_errors","ignore_repeated_source","ignore_user_abort","implicit_flush","include_path","intl.default_locale","intl.error_level","ldap.max_links","log_errors","log_errors_max_len","magic_quotes_gpc","magic_quotes_runtime","magic_quotes_sybase","mail.add_x_header","mail.force_extra_parameters","mail.log","max_execution_time","max_file_uploads","max_input_nesting_level","max_input_time","mbstring.detect_order","mbstring.encoding_translation","mbstring.func_overload","mbstring.http_input","mbstring.http_output","mbstring.http_output_conv_mimetype","mbstring.internal_encoding","mbstring.language","mbstring.script_encoding","mbstring.strict_detection","mbstring.substitute_character","mcrypt.algorithms_dir","mcrypt.modes_dir","memory_limit","mssql.allow_persistent","mssql.batchsize","mssql.charset","mssql.compatability_mode","mssql.connect_timeout","mssql.datetimeconvert","mssql.max_links","mssql.max_persistent","mssql.max_procs","mssql.min_error_severity","mssql.min_message_severity","mssql.secure_connection","mssql.textlimit","mssql.textsize","mssql.timeout","mysql.allow_local_infile","mysql.allow_persistent","mysql.cache_size","mysql.connect_timeout","mysql.default_host","mysql.default_password","mysql.default_port","mysql.default_socket","mysql.default_user","mysql.max_links","mysql.max_persistent","mysql.trace_mode","mysqli.allow_local_infile","mysqli.allow_persistent","mysqli.cache_size","mysqli.default_host","mysqli.default_port","mysqli.default_pw","mysqli.default_socket","mysqli.default_user","mysqli.max_links","mysqli.max_persistent","mysqli.reconnect","mysqlnd.collect_memory_statistics","mysqlnd.collect_statistics","mysqlnd.net_cmd_buffer_size","mysqlnd.net_read_buffer_size","oci8.connection_class","oci8.default_prefetch","oci8.events","oci8.max_persistent","oci8.old_oci_close_semantics","oci8.persistent_timeout","oci8.ping_interval","oci8.privileged_connect","oci8.statement_cache_size","odbc.allow_persistent","odbc.check_persistent","odbc.default_db","odbc.default_pw","odbc.default_user","odbc.defaultbinmode","odbc.defaultlrl","odbc.max_links","odbc.max_persistent","open_basedir","output_buffering","output_handler","pcre.backtrack_limit","pcre.recursion_limit","pdo_mysql.cache_size","pdo_mysql.default_socket","pdo_odbc.connection_pooling","pgsql.allow_persistent","pgsql.auto_reset_persistent","pgsql.ignore_notice","pgsql.log_notice","pgsql.max_links","pgsql.max_persistent","phar.cache_list","phar.readonly","phar.require_hash","post_max_size","realpath_cache_size","realpath_cache_ttl","register_argc_argv","register_globals","register_long_arrays","report_memleaks","report_zend_debug","request_order","safe_mode","safe_mode_allowed_env_vars","safe_mode_exec_dir","safe_mode_gid","safe_mode_include_dir","safe_mode_protected_env_vars","sendmail_from","sendmail_path","serialize_precision","session.auto_start","session.bug_compat_42","session.bug_compat_warn","session.cache_expire","session.cache_limiter","session.cookie_domain","session.cookie_httponly","session.cookie_lifetime","session.cookie_path","session.cookie_secure","session.entropy_file","session.entropy_length","session.gc_divisor","session.gc_maxlifetime","session.gc_probability","session.hash_bits_per_character","session.hash_function","session.name","session.referer_check","session.save_handler","session.save_path","session.serialize_handler","session.use_cookies","session.use_only_cookies","session.use_trans_sid","short_open_tag","soap.wsdl_cache_dir","soap.wsdl_cache_enabled","soap.wsdl_cache_limit","soap.wsdl_cache_ttl","sql.safe_mode","sqlite.assoc_case","sqlite3.extension_dir","sybct.allow_persistent","sybct.deadlock_retry_count","sybct.hostname","sybct.login_timeout","sybct.max_links","sybct.max_persistent","sybct.min_client_severity","sybct.min_server_severity","sybct.timeout","sysvshm.init_mem","tidy.clean_output","tidy.default_config","track_errors","unserialize_callback_func","upload_max_filesize","upload_tmp_dir","url_rewriter.tags","user_agent","user_dir","user_ini.cache_ttl","user_ini.filename","variables_order","xmlrpc_error_number","xmlrpc_errors","y2k_compliance","zlib.output_compression","zlib.output_compression_level","zlib.output_handler"],"severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933130","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: Variables Found","operator":"PM","opts":{"transform":["normalise_path","uri_decode_uni"]},"pattern":["$GLOBALS","$HTTP_COOKIE_VARS","$HTTP_ENV_VARS","$HTTP_GET_VARS","$HTTP_POST_FILES","$HTTP_POST_VARS","$HTTP_RAW_POST_DATA","$HTTP_REQUEST_VARS","$HTTP_SERVER_VARS","$_COOKIE","$_ENV","$_FILES","$_GET","$_POST","$_REQUEST","$_SERVER","$_SESSION","$argc","$argv"],"severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933140","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: I/O Stream Found","operator":"REGEX","pattern":"(?i)php://(?:std(?:in|out|err)|(?:in|out)put|fd|memory|temp|filter)","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933200","logdata":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}","msg":"PHP Injection Attack: Wrapper scheme detected","operator":"REFIND","opts":{"transform":["utf8_to_unicode","uri_decode_uni","remove_nulls","cmd_line"]},"pattern":"(?i:zlib|glob|phar|ssh2|rar|ogg|expect|zip)://","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933160","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: High-Risk PHP Function Call Found","operator":"REGEX","pattern":"(?i)\\b(?:s(?:e(?:t(?:_(?:e(?:xception|rror)_handler|magic_quotes_runtime|include_path)|defaultstub)|ssion_s(?:et_save_handler|tart))|qlite_(?:(?:(?:unbuffered|single|array)_)?query|create_(?:aggregate|function)|p?open|exec)|tr(?:eam_(?:context_create|socket_client)|ipc?slashes|rev)|implexml_load_(?:string|file)|ocket_c(?:onnect|reate)|h(?:ow_sourc|a1_fil)e|pl_autoload_register|ystem)|p(?:r(?:eg_(?:replace(?:_callback(?:_array)?)?|match(?:_all)?|split)|oc_(?:(?:terminat|clos|nic)e|get_status|open)|int_r)|o(?:six_(?:get(?:(?:e[gu]|g)id|login|pwnam)|mk(?:fifo|nod)|ttyname|kill)|pen)|hp(?:_(?:strip_whitespac|unam)e|version|info)|g_(?:(?:execut|prepar)e|connect|query)|a(?:rse_(?:ini_file|str)|ssthru)|utenv)|r(?:unkit_(?:function_(?:re(?:defin|nam)e|copy|add)|method_(?:re(?:defin|nam)e|copy|add)|constant_(?:redefine|add))|e(?:(?:gister_(?:shutdown|tick)|name)_function|ad(?:(?:gz)?file|_exif_data|dir))|awurl(?:de|en)code)|i(?:mage(?:createfrom(?:(?:jpe|pn)g|x[bp]m|wbmp|gif)|(?:jpe|pn)g|g(?:d2?|if)|2?wbmp|xbm)|s_(?:(?:(?:execut|write?|read)ab|fi)le|dir)|ni_(?:get(?:_all)?|set)|terator_apply|ptcembed)|g(?:et(?:_(?:c(?:urrent_use|fg_va)r|meta_tags)|my(?:[gpu]id|inode)|(?:lastmo|cw)d|imagesize|env)|z(?:(?:(?:defla|wri)t|encod|fil)e|compress|open|read)|lob)|a(?:rray_(?:u(?:intersect(?:_u?assoc)?|diff(?:_u?assoc)?)|intersect_u(?:assoc|key)|diff_u(?:assoc|key)|filter|reduce|map)|ssert(?:_options)?)|h(?:tml(?:specialchars(?:_decode)?|_entity_decode|entities)|(?:ash(?:_(?:update|hmac))?|ighlight)_file|e(?:ader_register_callback|x2bin))|f(?:i(?:le(?:(?:[acm]tim|inod)e|(?:_exist|perm)s|group)?|nfo_open)|tp_(?:nb_(?:ge|pu)|connec|ge|pu)t|(?:unction_exis|pu)ts|write|open)|o(?:b_(?:get_(?:c(?:ontents|lean)|flush)|end_(?:clean|flush)|clean|flush|start)|dbc_(?:result(?:_all)?|exec(?:ute)?|connect)|pendir)|m(?:b_(?:ereg(?:_(?:replace(?:_callback)?|match)|i(?:_replace)?)?|parse_str)|(?:ove_uploaded|d5)_file|ethod_exists|ysql_query|kdir)|e(?:x(?:if_(?:t(?:humbnail|agname)|imagetype|read_data)|ec)|scapeshell(?:arg|cmd)|rror_reporting|val)|c(?:url_(?:file_create|exec|init)|onvert_uuencode|reate_function|hr)|u(?:n(?:serialize|pack)|rl(?:de|en)code|[ak]?sort)|(?:json_(?:de|en)cod|debug_backtrac|tmpfil)e|b(?:(?:son_(?:de|en)|ase64_en)code|zopen)|var_dump)(?:\\s|/\\*.*\\*/|//.*|#.*)*\\(.*\\)","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"type":"URI"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933170","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: Serialized Object Injection","operator":"REGEX","pattern":"[oOcC]:\\d+:\".+?\":\\d+:{.*}","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["values","1"],"type":"REQUEST_HEADERS"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933180","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: Variable Function Call Found","operator":"REGEX","pattern":"\\$+(?:[a-zA-Z_\\x7f-\\xff][a-zA-Z0-9_\\x7f-\\xff]*|\\s*{.+})(?:\\s|\\[.+\\]|{.+}|/\\*.*\\*/|//.*|#.*)*\\(.*\\)","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"type":"URI"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"PHP_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"933210","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"PHP Injection Attack: Variable Function Call Found","operator":"REGEX","opts":{"transform":["uri_decode","replace_comments","remove_whitespace"]},"pattern":"(\\(.+\\)\\(.+\\)|\\(.+\\)['\"][a-zA-Z-_0-9]+['\"]\\(.+\\)|\\[\\d+\\]\\(.+\\)|\\{\\d+\\}\\(.+\\)|\\$[^(\\),.;\\x5c/]+\\(.+\\)|[\"'][a-zA-Z0-9-_\\x5c]+[\"']\\(.+\\)|\\([^\\)]*string[^\\)]*\\)[a-zA-Z-_0-9\"'.{}\\[\\]\\s]+\\([^\\)]*\\));","severity":"CRITICAL","tag":["application-multi","language-php","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"type":"URI"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"RCE_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"INBOUND_ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"944130","logdata":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}","msg":"Suspicious Java class detected","operator":"PM","pattern":["com.opensymphony.xwork2","com.sun.org.apache","java.io.BufferedInputStream","java.io.BufferedReader","java.io.ByteArrayInputStream","java.io.ByteArrayOutputStream","java.io.CharArrayReader","java.io.DataInputStream","java.io.File","java.io.FileOutputStream","java.io.FilePermission","java.io.FileWriter","java.io.FilterInputStream","java.io.FilterOutputStream","java.io.FilterReader","java.io.InputStream","java.io.InputStreamReader","java.io.LineNumberReader","java.io.ObjectOutputStream","java.io.OutputStream","java.io.PipedOutputStream","java.io.PipedReader","java.io.PrintStream","java.io.PushbackInputStream","java.io.Reader","java.io.StringReader","java.lang.Class","java.lang.Integer","java.lang.Number","java.lang.Object","java.lang.Process","java.lang.ProcessBuilder","java.lang.reflect","java.lang.Runtime","java.lang.String","java.lang.StringBuilder","java.lang.System","javax.script.ScriptEngineManager","org.apache.commons","org.apache.struts","org.apache.struts2","org.omg.CORBA","java.beans.XMLDecode"],"severity":"CRITICAL","tag":["application-multi","language-java","platform-multi","OWASP_CRS","capec/1000/152/248","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"type":"REQUEST_BODY"},{"type":"URI"},{"parse":["values","1"],"type":"REQUEST_HEADERS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"RCE_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"944140","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"Java Injection Attack: Java Script File Upload Found","operator":"REGEX","opts":{"transform":["lowercase"]},"pattern":".*\\.(?:jsp|jspx)\\.*$","severity":"CRITICAL","tag":["application-multi","language-java","platform-multi","OWASP_CRS","capec/1000/152/242"],"vars":[{"type":"FILES"},{"parse":["specific","X-Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X_Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X.Filename"],"type":"REQUEST_HEADERS"},{"parse":["specific","X-File-Name"],"type":"REQUEST_HEADERS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"RCE_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE_PL1","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}}]},"id":"944150","msg":"Potential Remote Command Execution: Log4j / Log4shell","operator":"REFIND","opts":{"transform":["uri_decode_uni","js_decode","html_decode"]},"pattern":"(?i)(?:\\$|&dollar;?)(?:\\{|&(?:lbrace|lcub);?)(?:[^}]{0,15}(?:\\$|&dollar;?)(?:\\{|&(?:lbrace|lcub);?)|(?:jndi|ctx))","severity":"CRITICAL","tag":["application-multi","language-java","platform-multi","OWASP_CRS","capec/1000/152/137/6","PCI/6.5.2"],"vars":[{"type":"REQUEST_LINE"},{"parse":["values","1"],"type":"REQUEST_ARGS"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["values","1"],"type":"REQUEST_HEADERS"}],"ver":"OWASP_CRS/4.0.0-rc1","attack_tag":"attack-virtualpatch","paranoia_level":1}]}