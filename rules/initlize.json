[{"actions":{"disrupt":"IGNORE","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"UA_HASH","value":"%{MATCHED_VAR}"}}]},"id":"901318","operator":"REFIND","opts":{"nolog":1,"transform":["sha1","hex_encode"]},"pattern":"^.*$","vars":[{"parse":["specific","User-Agent"],"type":"REQUEST_HEADERS"}],"ver":"OWASP_CRS/4.0.0-rc1"},{"actions":{"disrupt":"IGNORE","nondisrupt":[{"action":"initcol","data":{"col":"GLOBAL","value":"global"}},{"action":"initcol","data":{"col":"IP","value":"%{REMOTE_ADDR}_%{TX.UA_HASH}"}},{"action":"setvar","data":{"col":"TX","key":"REAL_IP","value":"%{REMOTE_ADDR}"}}]},"id":"901321","opts":{"nolog":1},"vars":[{"unconditional":1}],"ver":"OWASP_CRS/4.0.0-rc1"},{"actions":{"disrupt":"IGNORE"},"id":"901340","msg":"Enabling body inspection","op_negated":1,"operator":"REFIND","opts":{"nolog":1},"pattern":"(?:URLENCODED|MULTIPART|XML|JSON)","tag":[],"vars":[{"type":"REQBODY_PROCESSOR"}],"ver":"OWASP_CRS/4.0.0-rc1","paranoia_level":1},{"actions":{"disrupt":"CHAIN"},"id":"901350","operator":"EQUALS","opts":{"nolog":1,"parsepattern":1,"transform":["uri_decode"]},"pattern":"0","vars":[{"parse":["specific","ENFORCE_BODYPROC_URLENCODED"],"storage":1,"type":"TX"}],"ver":"OWASP_CRS/4.0.0-rc1"},{"actions":{"disrupt":"IGNORE","nondisrupt":[{"action":"request_body_processor","data":"URLENCODED"}]},"id":"901350","msg":"Enabling forced body inspection for ASCII content","op_negated":1,"operator":"REFIND","pattern":"(?:URLENCODED|MULTIPART|XML|JSON)","vars":[{"type":"REQBODY_PROCESSOR"}]},{"actions":{"disrupt":"IGNORE"},"id":"901400","operator":"EQUALS","opts":{"nolog":1,"parsepattern":1},"pattern":"0","skip_after":"END-SAMPLING","vars":[{"parse":["specific","SAMPLING_PERCENTAGE"],"storage":1,"type":"TX"}],"ver":"OWASP_CRS/4.0.0-rc1"},{"actions":{"disrupt":"IGNORE","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"SAMPLING_RND100","value":"%{TX.1}%{TX.2}"}}]},"id":"901410","operator":"REGEX","opts":{"nolog":1,"transform":["sha1","hex_encode"]},"pattern":"^[a-f]*([0-9])[a-f]*([0-9])","vars":[{"type":"UNIQUE_ID"}],"ver":"OWASP_CRS/4.0.0-rc1"},{"actions":{"disrupt":"IGNORE","nondisrupt":[{"action":"rule_remove_by_meta","data":1}]},"exceptions":["OWASP_CRS"],"id":"901450","msg":"Sampling: Disable the rule engine based on sampling_percentage %{TX.SAMPLING_PERCENTAGE} and random number %{TX.SAMPLING_RND100}","op_negated":1,"operator":"LESS","opts":{"nolog":1,"parsepattern":1},"pattern":"%{TX.SAMPLING_PERCENTAGE}","vars":[{"parse":["specific","SAMPLING_RND100"],"storage":1,"type":"TX"}],"ver":"OWASP_CRS/4.0.0-rc1"},{"actions":{"disrupt":"DENY"},"id":"END-SAMPLING","op_negated":1,"vars":[{"unconditional":1}]},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"status","data":500}]},"id":"901500","msg":"Detection paranoia level configured is lower than the paranoia level itself. This is illegal. Blocking request. Aborting","operator":"LESS","opts":{"parsepattern":1},"pattern":"%{TX.BLOCKING_PARANOIA_LEVEL}","vars":[{"parse":["specific","DETECTION_PARANOIA_LEVEL"],"storage":1,"type":"TX"}],"ver":"OWASP_CRS/4.0.0-rc1"},{"actions":{"disrupt":"CHAIN"},"id":"905100","operator":"EQUALS","opts":{"nolog":1,"parsepattern":1},"pattern":"GET /","tag":["application-multi","language-multi","platform-apache"],"vars":[{"type":"REQUEST_LINE"}],"ver":"OWASP_CRS/4.0.0-rc1"},{"actions":{"disrupt":"IGNORE","nondisrupt":[{"action":"rule_remove_by_meta","data":1}]},"exceptions":["OWASP_CRS"],"id":"905100","operator":"CIDR_MATCH","pattern":["127.0.0.1","::1"],"vars":[{"type":"REMOTE_ADDR"}]},{"actions":{"disrupt":"CHAIN"},"id":"905110","operator":"CIDR_MATCH","opts":{"nolog":1},"pattern":["127.0.0.1","::1"],"tag":["application-multi","language-multi","platform-apache"],"vars":[{"type":"REMOTE_ADDR"}],"ver":"OWASP_CRS/4.0.0-rc1"},{"actions":{"disrupt":"CHAIN"},"id":"905110","operator":"REFIND","opts":{"parsepattern":1},"pattern":"(internal dummy connection)$","vars":[{"parse":["specific","User-Agent"],"type":"REQUEST_HEADERS"}]},{"actions":{"disrupt":"IGNORE","nondisrupt":[{"action":"rule_remove_by_meta","data":1}]},"exceptions":["OWASP_CRS"],"id":"905110","operator":"REFIND","pattern":"^(?:GET /|OPTIONS \\*) HTTP/[12]\\.[01]$","vars":[{"type":"REQUEST_LINE"}]}]